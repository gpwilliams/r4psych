<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 Mixed Effects Models | R for Psych</title>
  <meta name="description" content="An introduction to data management and analysis for psychological research using R." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 Mixed Effects Models | R for Psych" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://glennwilliams.me/r4psych/" />
  
  <meta property="og:description" content="An introduction to data management and analysis for psychological research using R." />
  <meta name="github-repo" content="gpwilliams/r4psych" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 Mixed Effects Models | R for Psych" />
  
  <meta name="twitter:description" content="An introduction to data management and analysis for psychological research using R." />
  

<meta name="author" content="Glenn Williams" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="simulation-and-calculating-power.html"/>
<link rel="next" href="reporting-reproducible-research.html"/>
<script src="assets/header-attrs-2.13/header-attrs.js"></script>
<script src="assets/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="assets/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="assets/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="assets/anchor-sections-1.1.0/anchor-sections.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-117777827-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-117777827-1');
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">R for Psych</a></li>

<li class="divider"></li>
<li><a href="index.html#preface-overview">Preface &amp; Overview<span></span></a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction<span></span></a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#installation-and-setup"><i class="fa fa-check"></i><b>1.1</b> Installation and Setup<span></span></a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#working-directory-and-file-paths"><i class="fa fa-check"></i><b>1.2</b> Working Directory and File Paths<span></span></a></li>
<li class="chapter" data-level="1.3" data-path="introduction.html"><a href="introduction.html#packages"><i class="fa fa-check"></i><b>1.3</b> Packages<span></span></a></li>
<li class="chapter" data-level="1.4" data-path="introduction.html"><a href="introduction.html#objects-and-functions"><i class="fa fa-check"></i><b>1.4</b> Objects and Functions<span></span></a></li>
<li class="chapter" data-level="1.5" data-path="introduction.html"><a href="introduction.html#creating-and-accessing-data"><i class="fa fa-check"></i><b>1.5</b> Creating and Accessing Data<span></span></a></li>
<li class="chapter" data-level="1.6" data-path="introduction.html"><a href="introduction.html#good-practice"><i class="fa fa-check"></i><b>1.6</b> Good Practice<span></span></a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="introduction.html"><a href="introduction.html#data-checking-tips"><i class="fa fa-check"></i><b>1.6.1</b> Data Checking Tips<span></span></a></li>
<li class="chapter" data-level="1.6.2" data-path="introduction.html"><a href="introduction.html#style"><i class="fa fa-check"></i><b>1.6.2</b> Style<span></span></a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="introduction.html"><a href="introduction.html#exercises"><i class="fa fa-check"></i><b>1.7</b> Exercises<span></span></a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="introduction.html"><a href="introduction.html#question-1"><i class="fa fa-check"></i><b>1.7.1</b> Question 1<span></span></a></li>
<li class="chapter" data-level="1.7.2" data-path="introduction.html"><a href="introduction.html#question-2"><i class="fa fa-check"></i><b>1.7.2</b> Question 2<span></span></a></li>
<li class="chapter" data-level="1.7.3" data-path="introduction.html"><a href="introduction.html#question-3"><i class="fa fa-check"></i><b>1.7.3</b> Question 3<span></span></a></li>
<li class="chapter" data-level="1.7.4" data-path="introduction.html"><a href="introduction.html#question-4"><i class="fa fa-check"></i><b>1.7.4</b> Question 4<span></span></a></li>
<li class="chapter" data-level="1.7.5" data-path="introduction.html"><a href="introduction.html#question-5"><i class="fa fa-check"></i><b>1.7.5</b> Question 5<span></span></a></li>
<li class="chapter" data-level="1.7.6" data-path="introduction.html"><a href="introduction.html#question-6"><i class="fa fa-check"></i><b>1.7.6</b> Question 6<span></span></a></li>
<li class="chapter" data-level="1.7.7" data-path="introduction.html"><a href="introduction.html#question-7"><i class="fa fa-check"></i><b>1.7.7</b> Question 7<span></span></a></li>
<li class="chapter" data-level="1.7.8" data-path="introduction.html"><a href="introduction.html#question-8"><i class="fa fa-check"></i><b>1.7.8</b> Question 8<span></span></a></li>
<li class="chapter" data-level="1.7.9" data-path="introduction.html"><a href="introduction.html#question-9"><i class="fa fa-check"></i><b>1.7.9</b> Question 9<span></span></a></li>
<li class="chapter" data-level="1.7.10" data-path="introduction.html"><a href="introduction.html#question-10"><i class="fa fa-check"></i><b>1.7.10</b> Question 10<span></span></a></li>
<li class="chapter" data-level="1.7.11" data-path="introduction.html"><a href="introduction.html#question-11"><i class="fa fa-check"></i><b>1.7.11</b> Question 11<span></span></a></li>
<li class="chapter" data-level="1.7.12" data-path="introduction.html"><a href="introduction.html#question-12"><i class="fa fa-check"></i><b>1.7.12</b> Question 12<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-visualisation-1.html"><a href="data-visualisation-1.html"><i class="fa fa-check"></i><b>2</b> Data Visualisation 1<span></span></a>
<ul>
<li class="chapter" data-level="2.1" data-path="data-visualisation-1.html"><a href="data-visualisation-1.html#getting-started"><i class="fa fa-check"></i><b>2.1</b> Getting Started<span></span></a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="data-visualisation-1.html"><a href="data-visualisation-1.html#the-star-wars-tibble"><i class="fa fa-check"></i><b>2.1.1</b> The Star Wars Tibble<span></span></a></li>
<li class="chapter" data-level="2.1.2" data-path="data-visualisation-1.html"><a href="data-visualisation-1.html#plotting-in-ggplot2"><i class="fa fa-check"></i><b>2.1.2</b> Plotting in ggplot2<span></span></a></li>
<li class="chapter" data-level="2.1.3" data-path="data-visualisation-1.html"><a href="data-visualisation-1.html#cleaning-before-plotting"><i class="fa fa-check"></i><b>2.1.3</b> Cleaning Before Plotting<span></span></a></li>
<li class="chapter" data-level="2.1.4" data-path="data-visualisation-1.html"><a href="data-visualisation-1.html#changing-your-aesthetics"><i class="fa fa-check"></i><b>2.1.4</b> Changing Your Aesthetics<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="data-visualisation-1.html"><a href="data-visualisation-1.html#exploring-different-geoms"><i class="fa fa-check"></i><b>2.2</b> Exploring Different Geoms<span></span></a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="data-visualisation-1.html"><a href="data-visualisation-1.html#bar-plots"><i class="fa fa-check"></i><b>2.2.1</b> Bar Plots<span></span></a></li>
<li class="chapter" data-level="2.2.2" data-path="data-visualisation-1.html"><a href="data-visualisation-1.html#box-plots"><i class="fa fa-check"></i><b>2.2.2</b> Box Plots<span></span></a></li>
<li class="chapter" data-level="2.2.3" data-path="data-visualisation-1.html"><a href="data-visualisation-1.html#violin-plots"><i class="fa fa-check"></i><b>2.2.3</b> Violin Plots<span></span></a></li>
<li class="chapter" data-level="2.2.4" data-path="data-visualisation-1.html"><a href="data-visualisation-1.html#density-plots"><i class="fa fa-check"></i><b>2.2.4</b> Density Plots<span></span></a></li>
<li class="chapter" data-level="2.2.5" data-path="data-visualisation-1.html"><a href="data-visualisation-1.html#histograms"><i class="fa fa-check"></i><b>2.2.5</b> Histograms<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="data-visualisation-1.html"><a href="data-visualisation-1.html#exercises-1"><i class="fa fa-check"></i><b>2.3</b> Exercises<span></span></a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="data-visualisation-1.html"><a href="data-visualisation-1.html#main-exercises"><i class="fa fa-check"></i><b>2.3.1</b> Main Exercises<span></span></a></li>
<li class="chapter" data-level="2.3.2" data-path="data-visualisation-1.html"><a href="data-visualisation-1.html#question-1-1"><i class="fa fa-check"></i><b>2.3.2</b> Question 1<span></span></a></li>
<li class="chapter" data-level="2.3.3" data-path="data-visualisation-1.html"><a href="data-visualisation-1.html#question-2-1"><i class="fa fa-check"></i><b>2.3.3</b> Question 2<span></span></a></li>
<li class="chapter" data-level="2.3.4" data-path="data-visualisation-1.html"><a href="data-visualisation-1.html#question-3-1"><i class="fa fa-check"></i><b>2.3.4</b> Question 3<span></span></a></li>
<li class="chapter" data-level="2.3.5" data-path="data-visualisation-1.html"><a href="data-visualisation-1.html#question-4-1"><i class="fa fa-check"></i><b>2.3.5</b> Question 4<span></span></a></li>
<li class="chapter" data-level="2.3.6" data-path="data-visualisation-1.html"><a href="data-visualisation-1.html#question-5-1"><i class="fa fa-check"></i><b>2.3.6</b> Question 5<span></span></a></li>
<li class="chapter" data-level="2.3.7" data-path="data-visualisation-1.html"><a href="data-visualisation-1.html#question-6-1"><i class="fa fa-check"></i><b>2.3.7</b> Question 6<span></span></a></li>
<li class="chapter" data-level="2.3.8" data-path="data-visualisation-1.html"><a href="data-visualisation-1.html#question-7-1"><i class="fa fa-check"></i><b>2.3.8</b> Question 7<span></span></a></li>
<li class="chapter" data-level="2.3.9" data-path="data-visualisation-1.html"><a href="data-visualisation-1.html#question-8-1"><i class="fa fa-check"></i><b>2.3.9</b> Question 8<span></span></a></li>
<li class="chapter" data-level="2.3.10" data-path="data-visualisation-1.html"><a href="data-visualisation-1.html#question-9-1"><i class="fa fa-check"></i><b>2.3.10</b> Question 9<span></span></a></li>
<li class="chapter" data-level="2.3.11" data-path="data-visualisation-1.html"><a href="data-visualisation-1.html#question-10-1"><i class="fa fa-check"></i><b>2.3.11</b> Question 10<span></span></a></li>
<li class="chapter" data-level="2.3.12" data-path="data-visualisation-1.html"><a href="data-visualisation-1.html#additional-exercise"><i class="fa fa-check"></i><b>2.3.12</b> Additional Exercise<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-visualisation-2.html"><a href="data-visualisation-2.html"><i class="fa fa-check"></i><b>3</b> Data Visualisation 2<span></span></a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-visualisation-2.html"><a href="data-visualisation-2.html#customising-your-plots"><i class="fa fa-check"></i><b>3.1</b> Customising Your Plots<span></span></a></li>
<li class="chapter" data-level="3.2" data-path="data-visualisation-2.html"><a href="data-visualisation-2.html#pirate-plots"><i class="fa fa-check"></i><b>3.2</b> Pirate Plots<span></span></a></li>
<li class="chapter" data-level="3.3" data-path="data-visualisation-2.html"><a href="data-visualisation-2.html#faceting"><i class="fa fa-check"></i><b>3.3</b> Faceting<span></span></a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="data-visualisation-2.html"><a href="data-visualisation-2.html#facet-wrap"><i class="fa fa-check"></i><b>3.3.1</b> Facet Wrap<span></span></a></li>
<li class="chapter" data-level="3.3.2" data-path="data-visualisation-2.html"><a href="data-visualisation-2.html#facet-grid"><i class="fa fa-check"></i><b>3.3.2</b> Facet Grid<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="data-visualisation-2.html"><a href="data-visualisation-2.html#calculating-statisitcs-in-ggplot2"><i class="fa fa-check"></i><b>3.4</b> Calculating Statisitcs in ggplot2<span></span></a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="data-visualisation-2.html"><a href="data-visualisation-2.html#means-and-error-bars"><i class="fa fa-check"></i><b>3.4.1</b> Means and Error Bars<span></span></a></li>
<li class="chapter" data-level="3.4.2" data-path="data-visualisation-2.html"><a href="data-visualisation-2.html#model-fits"><i class="fa fa-check"></i><b>3.4.2</b> Model Fits<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="data-visualisation-2.html"><a href="data-visualisation-2.html#combining-plots"><i class="fa fa-check"></i><b>3.5</b> Combining Plots<span></span></a></li>
<li class="chapter" data-level="3.6" data-path="data-visualisation-2.html"><a href="data-visualisation-2.html#saving-plots"><i class="fa fa-check"></i><b>3.6</b> Saving Plots<span></span></a></li>
<li class="chapter" data-level="3.7" data-path="data-visualisation-2.html"><a href="data-visualisation-2.html#exercises-2"><i class="fa fa-check"></i><b>3.7</b> Exercises<span></span></a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="data-visualisation-2.html"><a href="data-visualisation-2.html#main-exercises-1"><i class="fa fa-check"></i><b>3.7.1</b> Main Exercises<span></span></a></li>
<li class="chapter" data-level="3.7.2" data-path="data-visualisation-2.html"><a href="data-visualisation-2.html#question-1-2"><i class="fa fa-check"></i><b>3.7.2</b> Question 1<span></span></a></li>
<li class="chapter" data-level="3.7.3" data-path="data-visualisation-2.html"><a href="data-visualisation-2.html#question-2-2"><i class="fa fa-check"></i><b>3.7.3</b> Question 2<span></span></a></li>
<li class="chapter" data-level="3.7.4" data-path="data-visualisation-2.html"><a href="data-visualisation-2.html#question-3-2"><i class="fa fa-check"></i><b>3.7.4</b> Question 3<span></span></a></li>
<li class="chapter" data-level="3.7.5" data-path="data-visualisation-2.html"><a href="data-visualisation-2.html#question-4-2"><i class="fa fa-check"></i><b>3.7.5</b> Question 4<span></span></a></li>
<li class="chapter" data-level="3.7.6" data-path="data-visualisation-2.html"><a href="data-visualisation-2.html#question-5-2"><i class="fa fa-check"></i><b>3.7.6</b> Question 5<span></span></a></li>
<li class="chapter" data-level="3.7.7" data-path="data-visualisation-2.html"><a href="data-visualisation-2.html#question-6-2"><i class="fa fa-check"></i><b>3.7.7</b> Question 6<span></span></a></li>
<li class="chapter" data-level="3.7.8" data-path="data-visualisation-2.html"><a href="data-visualisation-2.html#question-7-2"><i class="fa fa-check"></i><b>3.7.8</b> Question 7<span></span></a></li>
<li class="chapter" data-level="3.7.9" data-path="data-visualisation-2.html"><a href="data-visualisation-2.html#question-8-2"><i class="fa fa-check"></i><b>3.7.9</b> Question 8<span></span></a></li>
<li class="chapter" data-level="3.7.10" data-path="data-visualisation-2.html"><a href="data-visualisation-2.html#question-9-2"><i class="fa fa-check"></i><b>3.7.10</b> Question 9<span></span></a></li>
<li class="chapter" data-level="3.7.11" data-path="data-visualisation-2.html"><a href="data-visualisation-2.html#additional-exercise-1"><i class="fa fa-check"></i><b>3.7.11</b> Additional Exercise<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="data-manipulation-1.html"><a href="data-manipulation-1.html"><i class="fa fa-check"></i><b>4</b> Data Manipulation 1<span></span></a>
<ul>
<li class="chapter" data-level="4.1" data-path="data-manipulation-1.html"><a href="data-manipulation-1.html#getting-started-1"><i class="fa fa-check"></i><b>4.1</b> Getting Started<span></span></a></li>
<li class="chapter" data-level="4.2" data-path="data-manipulation-1.html"><a href="data-manipulation-1.html#data-formats"><i class="fa fa-check"></i><b>4.2</b> Data Formats<span></span></a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="data-manipulation-1.html"><a href="data-manipulation-1.html#loading-data"><i class="fa fa-check"></i><b>4.2.1</b> Loading Data<span></span></a></li>
<li class="chapter" data-level="4.2.2" data-path="data-manipulation-1.html"><a href="data-manipulation-1.html#wide-and-long-data"><i class="fa fa-check"></i><b>4.2.2</b> Wide and Long Data<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="data-manipulation-1.html"><a href="data-manipulation-1.html#reformatting-data"><i class="fa fa-check"></i><b>4.3</b> Reformatting Data<span></span></a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="data-manipulation-1.html"><a href="data-manipulation-1.html#gathering-data"><i class="fa fa-check"></i><b>4.3.1</b> Gathering Data<span></span></a></li>
<li class="chapter" data-level="4.3.2" data-path="data-manipulation-1.html"><a href="data-manipulation-1.html#separating-columns"><i class="fa fa-check"></i><b>4.3.2</b> Separating Columns<span></span></a></li>
<li class="chapter" data-level="4.3.3" data-path="data-manipulation-1.html"><a href="data-manipulation-1.html#spreading-data"><i class="fa fa-check"></i><b>4.3.3</b> Spreading Data<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="data-manipulation-1.html"><a href="data-manipulation-1.html#joins"><i class="fa fa-check"></i><b>4.4</b> Joins<span></span></a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="data-manipulation-1.html"><a href="data-manipulation-1.html#mutating-joins"><i class="fa fa-check"></i><b>4.4.1</b> Mutating Joins<span></span></a></li>
<li class="chapter" data-level="4.4.2" data-path="data-manipulation-1.html"><a href="data-manipulation-1.html#filtering-joins"><i class="fa fa-check"></i><b>4.4.2</b> Filtering Joins<span></span></a></li>
<li class="chapter" data-level="4.4.3" data-path="data-manipulation-1.html"><a href="data-manipulation-1.html#binding-joins"><i class="fa fa-check"></i><b>4.4.3</b> Binding Joins<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="data-manipulation-1.html"><a href="data-manipulation-1.html#checking-for-unique-and-duplicate-information"><i class="fa fa-check"></i><b>4.5</b> Checking for Unique and Duplicate Information<span></span></a></li>
<li class="chapter" data-level="4.6" data-path="data-manipulation-1.html"><a href="data-manipulation-1.html#exercises-3"><i class="fa fa-check"></i><b>4.6</b> Exercises<span></span></a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="data-manipulation-1.html"><a href="data-manipulation-1.html#introduction-and-setup"><i class="fa fa-check"></i><b>4.6.1</b> Introduction and Setup<span></span></a></li>
<li class="chapter" data-level="4.6.2" data-path="data-manipulation-1.html"><a href="data-manipulation-1.html#long-and-wide-data"><i class="fa fa-check"></i><b>4.6.2</b> Long and Wide Data<span></span></a></li>
<li class="chapter" data-level="4.6.3" data-path="data-manipulation-1.html"><a href="data-manipulation-1.html#uniting-and-separating-columns"><i class="fa fa-check"></i><b>4.6.3</b> Uniting and Separating Columns<span></span></a></li>
<li class="chapter" data-level="4.6.4" data-path="data-manipulation-1.html"><a href="data-manipulation-1.html#mutating-joins-1"><i class="fa fa-check"></i><b>4.6.4</b> Mutating Joins<span></span></a></li>
<li class="chapter" data-level="4.6.5" data-path="data-manipulation-1.html"><a href="data-manipulation-1.html#filtering-joins-1"><i class="fa fa-check"></i><b>4.6.5</b> Filtering Joins<span></span></a></li>
<li class="chapter" data-level="4.6.6" data-path="data-manipulation-1.html"><a href="data-manipulation-1.html#binding-joins-1"><i class="fa fa-check"></i><b>4.6.6</b> Binding Joins<span></span></a></li>
<li class="chapter" data-level="4.6.7" data-path="data-manipulation-1.html"><a href="data-manipulation-1.html#checking-for-duplicates"><i class="fa fa-check"></i><b>4.6.7</b> Checking for Duplicates<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="data-manipulation-2.html"><a href="data-manipulation-2.html"><i class="fa fa-check"></i><b>5</b> Data Manipulation 2<span></span></a>
<ul>
<li class="chapter" data-level="5.1" data-path="data-manipulation-2.html"><a href="data-manipulation-2.html#getting-started-2"><i class="fa fa-check"></i><b>5.1</b> Getting Started<span></span></a></li>
<li class="chapter" data-level="5.2" data-path="data-manipulation-2.html"><a href="data-manipulation-2.html#understanding-our-data"><i class="fa fa-check"></i><b>5.2</b> Understanding our Data<span></span></a></li>
<li class="chapter" data-level="5.3" data-path="data-manipulation-2.html"><a href="data-manipulation-2.html#preparing-our-data"><i class="fa fa-check"></i><b>5.3</b> Preparing our Data<span></span></a></li>
<li class="chapter" data-level="5.4" data-path="data-manipulation-2.html"><a href="data-manipulation-2.html#selecting-columns"><i class="fa fa-check"></i><b>5.4</b> Selecting Columns<span></span></a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="data-manipulation-2.html"><a href="data-manipulation-2.html#renaming-and-reordering-columns"><i class="fa fa-check"></i><b>5.4.1</b> Renaming and Reordering Columns<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="data-manipulation-2.html"><a href="data-manipulation-2.html#creating-and-changing-columns"><i class="fa fa-check"></i><b>5.5</b> Creating and Changing Columns<span></span></a></li>
<li class="chapter" data-level="5.6" data-path="data-manipulation-2.html"><a href="data-manipulation-2.html#filtering-to-observations"><i class="fa fa-check"></i><b>5.6</b> Filtering to Observations<span></span></a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="data-manipulation-2.html"><a href="data-manipulation-2.html#filtering-with-logical-operations"><i class="fa fa-check"></i><b>5.6.1</b> Filtering with Logical Operations<span></span></a></li>
<li class="chapter" data-level="5.6.2" data-path="data-manipulation-2.html"><a href="data-manipulation-2.html#combining-filtering-criteria"><i class="fa fa-check"></i><b>5.6.2</b> Combining Filtering Criteria<span></span></a></li>
<li class="chapter" data-level="5.6.3" data-path="data-manipulation-2.html"><a href="data-manipulation-2.html#removing-by-ceriteria"><i class="fa fa-check"></i><b>5.6.3</b> Removing by Ceriteria<span></span></a></li>
<li class="chapter" data-level="5.6.4" data-path="data-manipulation-2.html"><a href="data-manipulation-2.html#handling-nas"><i class="fa fa-check"></i><b>5.6.4</b> Handling NAs<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="data-manipulation-2.html"><a href="data-manipulation-2.html#arranging-data"><i class="fa fa-check"></i><b>5.7</b> Arranging Data<span></span></a></li>
<li class="chapter" data-level="5.8" data-path="data-manipulation-2.html"><a href="data-manipulation-2.html#summarising-data"><i class="fa fa-check"></i><b>5.8</b> Summarising Data<span></span></a></li>
<li class="chapter" data-level="5.9" data-path="data-manipulation-2.html"><a href="data-manipulation-2.html#grouping-data"><i class="fa fa-check"></i><b>5.9</b> Grouping Data<span></span></a>
<ul>
<li class="chapter" data-level="5.9.1" data-path="data-manipulation-2.html"><a href="data-manipulation-2.html#ungrouping-data"><i class="fa fa-check"></i><b>5.9.1</b> Ungrouping Data<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5.10" data-path="data-manipulation-2.html"><a href="data-manipulation-2.html#chaining-many-functions"><i class="fa fa-check"></i><b>5.10</b> Chaining Many Functions<span></span></a></li>
<li class="chapter" data-level="5.11" data-path="data-manipulation-2.html"><a href="data-manipulation-2.html#saving-data"><i class="fa fa-check"></i><b>5.11</b> Saving Data<span></span></a>
<ul>
<li class="chapter" data-level="5.11.1" data-path="data-manipulation-2.html"><a href="data-manipulation-2.html#csv-files"><i class="fa fa-check"></i><b>5.11.1</b> CSV Files<span></span></a></li>
<li class="chapter" data-level="5.11.2" data-path="data-manipulation-2.html"><a href="data-manipulation-2.html#r-data-files"><i class="fa fa-check"></i><b>5.11.2</b> R Data Files<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5.12" data-path="data-manipulation-2.html"><a href="data-manipulation-2.html#exercises-4"><i class="fa fa-check"></i><b>5.12</b> Exercises<span></span></a>
<ul>
<li class="chapter" data-level="5.12.1" data-path="data-manipulation-2.html"><a href="data-manipulation-2.html#question-1-4"><i class="fa fa-check"></i><b>5.12.1</b> Question 1<span></span></a></li>
<li class="chapter" data-level="5.12.2" data-path="data-manipulation-2.html"><a href="data-manipulation-2.html#question-2-4"><i class="fa fa-check"></i><b>5.12.2</b> Question 2<span></span></a></li>
<li class="chapter" data-level="5.12.3" data-path="data-manipulation-2.html"><a href="data-manipulation-2.html#question-3-4"><i class="fa fa-check"></i><b>5.12.3</b> Question 3<span></span></a></li>
<li class="chapter" data-level="5.12.4" data-path="data-manipulation-2.html"><a href="data-manipulation-2.html#question-4-4"><i class="fa fa-check"></i><b>5.12.4</b> Question 4<span></span></a></li>
<li class="chapter" data-level="5.12.5" data-path="data-manipulation-2.html"><a href="data-manipulation-2.html#question-5-4"><i class="fa fa-check"></i><b>5.12.5</b> Question 5<span></span></a></li>
<li class="chapter" data-level="5.12.6" data-path="data-manipulation-2.html"><a href="data-manipulation-2.html#question-6-4"><i class="fa fa-check"></i><b>5.12.6</b> Question 6<span></span></a></li>
<li class="chapter" data-level="5.12.7" data-path="data-manipulation-2.html"><a href="data-manipulation-2.html#question-7-4"><i class="fa fa-check"></i><b>5.12.7</b> Question 7<span></span></a></li>
<li class="chapter" data-level="5.12.8" data-path="data-manipulation-2.html"><a href="data-manipulation-2.html#question-8-4"><i class="fa fa-check"></i><b>5.12.8</b> Question 8<span></span></a></li>
<li class="chapter" data-level="5.12.9" data-path="data-manipulation-2.html"><a href="data-manipulation-2.html#question-9-4"><i class="fa fa-check"></i><b>5.12.9</b> Question 9<span></span></a></li>
<li class="chapter" data-level="5.12.10" data-path="data-manipulation-2.html"><a href="data-manipulation-2.html#question-10-3"><i class="fa fa-check"></i><b>5.12.10</b> Question 10<span></span></a></li>
<li class="chapter" data-level="5.12.11" data-path="data-manipulation-2.html"><a href="data-manipulation-2.html#question-11-1"><i class="fa fa-check"></i><b>5.12.11</b> Question 11<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="simple-statistical-tests.html"><a href="simple-statistical-tests.html"><i class="fa fa-check"></i><b>6</b> Simple Statistical Tests<span></span></a>
<ul>
<li class="chapter" data-level="6.1" data-path="simple-statistical-tests.html"><a href="simple-statistical-tests.html#getting-started-3"><i class="fa fa-check"></i><b>6.1</b> Getting Started<span></span></a></li>
<li class="chapter" data-level="6.2" data-path="simple-statistical-tests.html"><a href="simple-statistical-tests.html#correlation"><i class="fa fa-check"></i><b>6.2</b> Correlation<span></span></a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="simple-statistical-tests.html"><a href="simple-statistical-tests.html#analysing-real-data"><i class="fa fa-check"></i><b>6.2.1</b> Analysing Real Data<span></span></a></li>
<li class="chapter" data-level="6.2.2" data-path="simple-statistical-tests.html"><a href="simple-statistical-tests.html#checking-assumptions"><i class="fa fa-check"></i><b>6.2.2</b> Checking Assumptions<span></span></a></li>
<li class="chapter" data-level="6.2.3" data-path="simple-statistical-tests.html"><a href="simple-statistical-tests.html#running-a-correlation"><i class="fa fa-check"></i><b>6.2.3</b> Running a Correlation<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="simple-statistical-tests.html"><a href="simple-statistical-tests.html#t-tests"><i class="fa fa-check"></i><b>6.3</b> <em>t</em>-tests<span></span></a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="simple-statistical-tests.html"><a href="simple-statistical-tests.html#one-sample-t-tests"><i class="fa fa-check"></i><b>6.3.1</b> One-Sample <em>t</em>-tests<span></span></a></li>
<li class="chapter" data-level="6.3.2" data-path="simple-statistical-tests.html"><a href="simple-statistical-tests.html#independent-samples-t-tests"><i class="fa fa-check"></i><b>6.3.2</b> Independent-Samples <em>t</em>-tests<span></span></a></li>
<li class="chapter" data-level="6.3.3" data-path="simple-statistical-tests.html"><a href="simple-statistical-tests.html#paired-samples-t-tests"><i class="fa fa-check"></i><b>6.3.3</b> Paired-Samples <em>t</em>-tests<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="simple-statistical-tests.html"><a href="simple-statistical-tests.html#anova"><i class="fa fa-check"></i><b>6.4</b> ANOVA<span></span></a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="simple-statistical-tests.html"><a href="simple-statistical-tests.html#one-way-anova"><i class="fa fa-check"></i><b>6.4.1</b> One-Way ANOVA<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="simple-statistical-tests.html"><a href="simple-statistical-tests.html#linear-regression"><i class="fa fa-check"></i><b>6.5</b> Linear Regression<span></span></a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="simple-statistical-tests.html"><a href="simple-statistical-tests.html#general-linear-model"><i class="fa fa-check"></i><b>6.5.1</b> General Linear Model<span></span></a></li>
<li class="chapter" data-level="6.5.2" data-path="simple-statistical-tests.html"><a href="simple-statistical-tests.html#generalised-linear-model"><i class="fa fa-check"></i><b>6.5.2</b> Generalised Linear Model<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="simple-statistical-tests.html"><a href="simple-statistical-tests.html#exercises-5"><i class="fa fa-check"></i><b>6.6</b> Exercises<span></span></a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="simple-statistical-tests.html"><a href="simple-statistical-tests.html#question-1-5"><i class="fa fa-check"></i><b>6.6.1</b> Question 1<span></span></a></li>
<li class="chapter" data-level="6.6.2" data-path="simple-statistical-tests.html"><a href="simple-statistical-tests.html#question-2-5"><i class="fa fa-check"></i><b>6.6.2</b> Question 2<span></span></a></li>
<li class="chapter" data-level="6.6.3" data-path="simple-statistical-tests.html"><a href="simple-statistical-tests.html#question-3-5"><i class="fa fa-check"></i><b>6.6.3</b> Question 3<span></span></a></li>
<li class="chapter" data-level="6.6.4" data-path="simple-statistical-tests.html"><a href="simple-statistical-tests.html#question-4-5"><i class="fa fa-check"></i><b>6.6.4</b> Question 4<span></span></a></li>
<li class="chapter" data-level="6.6.5" data-path="simple-statistical-tests.html"><a href="simple-statistical-tests.html#question-5-5"><i class="fa fa-check"></i><b>6.6.5</b> Question 5<span></span></a></li>
<li class="chapter" data-level="6.6.6" data-path="simple-statistical-tests.html"><a href="simple-statistical-tests.html#question-6-5"><i class="fa fa-check"></i><b>6.6.6</b> Question 6<span></span></a></li>
<li class="chapter" data-level="6.6.7" data-path="simple-statistical-tests.html"><a href="simple-statistical-tests.html#question-7-5"><i class="fa fa-check"></i><b>6.6.7</b> Question 7<span></span></a></li>
<li class="chapter" data-level="6.6.8" data-path="simple-statistical-tests.html"><a href="simple-statistical-tests.html#question-8-5"><i class="fa fa-check"></i><b>6.6.8</b> Question 8<span></span></a></li>
<li class="chapter" data-level="6.6.9" data-path="simple-statistical-tests.html"><a href="simple-statistical-tests.html#question-9-5"><i class="fa fa-check"></i><b>6.6.9</b> Question 9<span></span></a></li>
<li class="chapter" data-level="6.6.10" data-path="simple-statistical-tests.html"><a href="simple-statistical-tests.html#question-10-4"><i class="fa fa-check"></i><b>6.6.10</b> Question 10<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="advanced-statistical-tests.html"><a href="advanced-statistical-tests.html"><i class="fa fa-check"></i><b>7</b> Advanced Statistical Tests<span></span></a>
<ul>
<li class="chapter" data-level="7.1" data-path="advanced-statistical-tests.html"><a href="advanced-statistical-tests.html#getting-started-4"><i class="fa fa-check"></i><b>7.1</b> Getting Started<span></span></a></li>
<li class="chapter" data-level="7.2" data-path="advanced-statistical-tests.html"><a href="advanced-statistical-tests.html#multilevel-analyses"><i class="fa fa-check"></i><b>7.2</b> Multilevel Analyses<span></span></a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="advanced-statistical-tests.html"><a href="advanced-statistical-tests.html#preparation-of-data"><i class="fa fa-check"></i><b>7.2.1</b> Preparation of Data<span></span></a></li>
<li class="chapter" data-level="7.2.2" data-path="advanced-statistical-tests.html"><a href="advanced-statistical-tests.html#multilevel-regression"><i class="fa fa-check"></i><b>7.2.2</b> Multilevel Regression<span></span></a></li>
<li class="chapter" data-level="7.2.3" data-path="advanced-statistical-tests.html"><a href="advanced-statistical-tests.html#multilevel-anova"><i class="fa fa-check"></i><b>7.2.3</b> Multilevel ANOVA<span></span></a></li>
<li class="chapter" data-level="7.2.4" data-path="advanced-statistical-tests.html"><a href="advanced-statistical-tests.html#multiple-contrasts"><i class="fa fa-check"></i><b>7.2.4</b> Multiple Contrasts<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="advanced-statistical-tests.html"><a href="advanced-statistical-tests.html#multifactorial-analyses"><i class="fa fa-check"></i><b>7.3</b> Multifactorial Analyses<span></span></a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="advanced-statistical-tests.html"><a href="advanced-statistical-tests.html#multifactorial-anova"><i class="fa fa-check"></i><b>7.3.1</b> Multifactorial ANOVA<span></span></a></li>
<li class="chapter" data-level="7.3.2" data-path="advanced-statistical-tests.html"><a href="advanced-statistical-tests.html#multiple-regression"><i class="fa fa-check"></i><b>7.3.2</b> Multiple Regression<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="advanced-statistical-tests.html"><a href="advanced-statistical-tests.html#mixed-analyses"><i class="fa fa-check"></i><b>7.4</b> Mixed Analyses<span></span></a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="advanced-statistical-tests.html"><a href="advanced-statistical-tests.html#mixed-linear-models"><i class="fa fa-check"></i><b>7.4.1</b> Mixed Linear Models<span></span></a></li>
<li class="chapter" data-level="7.4.2" data-path="advanced-statistical-tests.html"><a href="advanced-statistical-tests.html#mixed-anova"><i class="fa fa-check"></i><b>7.4.2</b> Mixed ANOVA<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="advanced-statistical-tests.html"><a href="advanced-statistical-tests.html#a-note-on-sum-of-squares"><i class="fa fa-check"></i><b>7.5</b> A Note on Sum of Squares<span></span></a></li>
<li class="chapter" data-level="7.6" data-path="advanced-statistical-tests.html"><a href="advanced-statistical-tests.html#exercises-6"><i class="fa fa-check"></i><b>7.6</b> Exercises<span></span></a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="advanced-statistical-tests.html"><a href="advanced-statistical-tests.html#question-1-6"><i class="fa fa-check"></i><b>7.6.1</b> Question 1<span></span></a></li>
<li class="chapter" data-level="7.6.2" data-path="advanced-statistical-tests.html"><a href="advanced-statistical-tests.html#question-2-6"><i class="fa fa-check"></i><b>7.6.2</b> Question 2<span></span></a></li>
<li class="chapter" data-level="7.6.3" data-path="advanced-statistical-tests.html"><a href="advanced-statistical-tests.html#question-3-6"><i class="fa fa-check"></i><b>7.6.3</b> Question 3<span></span></a></li>
<li class="chapter" data-level="7.6.4" data-path="advanced-statistical-tests.html"><a href="advanced-statistical-tests.html#question-4-6"><i class="fa fa-check"></i><b>7.6.4</b> Question 4<span></span></a></li>
<li class="chapter" data-level="7.6.5" data-path="advanced-statistical-tests.html"><a href="advanced-statistical-tests.html#question-5-6"><i class="fa fa-check"></i><b>7.6.5</b> Question 5<span></span></a></li>
<li class="chapter" data-level="7.6.6" data-path="advanced-statistical-tests.html"><a href="advanced-statistical-tests.html#question-6-6"><i class="fa fa-check"></i><b>7.6.6</b> Question 6<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="simulation-and-calculating-power.html"><a href="simulation-and-calculating-power.html"><i class="fa fa-check"></i><b>8</b> Simulation and Calculating Power<span></span></a>
<ul>
<li class="chapter" data-level="8.1" data-path="simulation-and-calculating-power.html"><a href="simulation-and-calculating-power.html#getting-started-5"><i class="fa fa-check"></i><b>8.1</b> Getting Started<span></span></a></li>
<li class="chapter" data-level="8.2" data-path="simulation-and-calculating-power.html"><a href="simulation-and-calculating-power.html#simulating-data"><i class="fa fa-check"></i><b>8.2</b> Simulating Data<span></span></a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="simulation-and-calculating-power.html"><a href="simulation-and-calculating-power.html#the-uniform-distribution"><i class="fa fa-check"></i><b>8.2.1</b> The Uniform Distribution<span></span></a></li>
<li class="chapter" data-level="8.2.2" data-path="simulation-and-calculating-power.html"><a href="simulation-and-calculating-power.html#the-normal-distribution"><i class="fa fa-check"></i><b>8.2.2</b> The Normal Distribution<span></span></a></li>
<li class="chapter" data-level="8.2.3" data-path="simulation-and-calculating-power.html"><a href="simulation-and-calculating-power.html#the-binomial-distribution"><i class="fa fa-check"></i><b>8.2.3</b> The Binomial Distribution<span></span></a></li>
<li class="chapter" data-level="8.2.4" data-path="simulation-and-calculating-power.html"><a href="simulation-and-calculating-power.html#flexible-sampling"><i class="fa fa-check"></i><b>8.2.4</b> Flexible Sampling<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="simulation-and-calculating-power.html"><a href="simulation-and-calculating-power.html#sampling-for-inference"><i class="fa fa-check"></i><b>8.3</b> Sampling for Inference<span></span></a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="simulation-and-calculating-power.html"><a href="simulation-and-calculating-power.html#understanding-p-values-and-type-i-errors"><i class="fa fa-check"></i><b>8.3.1</b> Understanding p-values and Type-I Errors<span></span></a></li>
<li class="chapter" data-level="8.3.2" data-path="simulation-and-calculating-power.html"><a href="simulation-and-calculating-power.html#understanding-power-and-type-ii-errors"><i class="fa fa-check"></i><b>8.3.2</b> Understanding Power and Type-II Errors<span></span></a></li>
<li class="chapter" data-level="8.3.3" data-path="simulation-and-calculating-power.html"><a href="simulation-and-calculating-power.html#flexible-power-analyses-with-simulation"><i class="fa fa-check"></i><b>8.3.3</b> Flexible Power Analyses with Simulation<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="simulation-and-calculating-power.html"><a href="simulation-and-calculating-power.html#performing-power-analyses-from-packages"><i class="fa fa-check"></i><b>8.4</b> Performing Power Analyses from Packages<span></span></a></li>
<li class="chapter" data-level="8.5" data-path="simulation-and-calculating-power.html"><a href="simulation-and-calculating-power.html#exercises-7"><i class="fa fa-check"></i><b>8.5</b> Exercises<span></span></a>
<ul>
<li class="chapter" data-level="8.5.1" data-path="simulation-and-calculating-power.html"><a href="simulation-and-calculating-power.html#introduction-and-setup-1"><i class="fa fa-check"></i><b>8.5.1</b> Introduction and Setup<span></span></a></li>
<li class="chapter" data-level="8.5.2" data-path="simulation-and-calculating-power.html"><a href="simulation-and-calculating-power.html#question-1-7"><i class="fa fa-check"></i><b>8.5.2</b> Question 1<span></span></a></li>
<li class="chapter" data-level="8.5.3" data-path="simulation-and-calculating-power.html"><a href="simulation-and-calculating-power.html#question-2-7"><i class="fa fa-check"></i><b>8.5.3</b> Question 2<span></span></a></li>
<li class="chapter" data-level="8.5.4" data-path="simulation-and-calculating-power.html"><a href="simulation-and-calculating-power.html#question-3-7"><i class="fa fa-check"></i><b>8.5.4</b> Question 3<span></span></a></li>
<li class="chapter" data-level="8.5.5" data-path="simulation-and-calculating-power.html"><a href="simulation-and-calculating-power.html#question-4-7"><i class="fa fa-check"></i><b>8.5.5</b> Question 4<span></span></a></li>
<li class="chapter" data-level="8.5.6" data-path="simulation-and-calculating-power.html"><a href="simulation-and-calculating-power.html#question-5-7"><i class="fa fa-check"></i><b>8.5.6</b> Question 5<span></span></a></li>
<li class="chapter" data-level="8.5.7" data-path="simulation-and-calculating-power.html"><a href="simulation-and-calculating-power.html#question-6-7"><i class="fa fa-check"></i><b>8.5.7</b> Question 6<span></span></a></li>
<li class="chapter" data-level="8.5.8" data-path="simulation-and-calculating-power.html"><a href="simulation-and-calculating-power.html#question-7-6"><i class="fa fa-check"></i><b>8.5.8</b> Question 7<span></span></a></li>
<li class="chapter" data-level="8.5.9" data-path="simulation-and-calculating-power.html"><a href="simulation-and-calculating-power.html#question-8-6"><i class="fa fa-check"></i><b>8.5.9</b> Question 8<span></span></a></li>
<li class="chapter" data-level="8.5.10" data-path="simulation-and-calculating-power.html"><a href="simulation-and-calculating-power.html#question-9-6"><i class="fa fa-check"></i><b>8.5.10</b> Question 9<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="mixed-effects-models.html"><a href="mixed-effects-models.html"><i class="fa fa-check"></i><b>9</b> Mixed Effects Models<span></span></a>
<ul>
<li class="chapter" data-level="9.1" data-path="mixed-effects-models.html"><a href="mixed-effects-models.html#getting-started-6"><i class="fa fa-check"></i><b>9.1</b> Getting Started<span></span></a></li>
<li class="chapter" data-level="9.2" data-path="mixed-effects-models.html"><a href="mixed-effects-models.html#why-mixed-effects-models"><i class="fa fa-check"></i><b>9.2</b> Why Mixed Effects Models<span></span></a></li>
<li class="chapter" data-level="9.3" data-path="mixed-effects-models.html"><a href="mixed-effects-models.html#how-do-mixed-effects-models-work"><i class="fa fa-check"></i><b>9.3</b> How Do Mixed Effects Models Work?<span></span></a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="mixed-effects-models.html"><a href="mixed-effects-models.html#fixed-and-random-effects"><i class="fa fa-check"></i><b>9.3.1</b> Fixed and Random Effects<span></span></a></li>
<li class="chapter" data-level="9.3.2" data-path="mixed-effects-models.html"><a href="mixed-effects-models.html#specifying-your-random-effects-structure"><i class="fa fa-check"></i><b>9.3.2</b> Specifying your Random Effects Structure<span></span></a></li>
<li class="chapter" data-level="9.3.3" data-path="mixed-effects-models.html"><a href="mixed-effects-models.html#partial-pooling-of-data"><i class="fa fa-check"></i><b>9.3.3</b> Partial-Pooling of Data<span></span></a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="mixed-effects-models.html"><a href="mixed-effects-models.html#interpreting-mixed-effects-model-output"><i class="fa fa-check"></i><b>9.4</b> Interpreting Mixed Effects Model Output<span></span></a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="mixed-effects-models.html"><a href="mixed-effects-models.html#calculating-p-values-for-parameter-estimates"><i class="fa fa-check"></i><b>9.4.1</b> Calculating p-values for Parameter Estimates<span></span></a></li>
<li class="chapter" data-level="9.4.2" data-path="mixed-effects-models.html"><a href="mixed-effects-models.html#model-selection"><i class="fa fa-check"></i><b>9.4.2</b> Model Selection<span></span></a></li>
<li class="chapter" data-level="9.4.3" data-path="mixed-effects-models.html"><a href="mixed-effects-models.html#failure-to-converge-what-should-i-do"><i class="fa fa-check"></i><b>9.4.3</b> Failure to Converge: What Should I Do?<span></span></a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="mixed-effects-models.html"><a href="mixed-effects-models.html#test-assumptions"><i class="fa fa-check"></i><b>9.5</b> Test Assumptions<span></span></a></li>
<li class="chapter" data-level="9.6" data-path="mixed-effects-models.html"><a href="mixed-effects-models.html#generalised-mixed-effects-models"><i class="fa fa-check"></i><b>9.6</b> Generalised Mixed Effects Models<span></span></a></li>
<li class="chapter" data-level="9.7" data-path="mixed-effects-models.html"><a href="mixed-effects-models.html#a-note-on-power-effect-sizes-and-pairwise-comparisons"><i class="fa fa-check"></i><b>9.7</b> A Note on Power, Effect Sizes, and Pairwise Comparisons<span></span></a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="mixed-effects-models.html"><a href="mixed-effects-models.html#power"><i class="fa fa-check"></i><b>9.7.1</b> Power<span></span></a></li>
<li class="chapter" data-level="9.7.2" data-path="mixed-effects-models.html"><a href="mixed-effects-models.html#effect-sizes"><i class="fa fa-check"></i><b>9.7.2</b> Effect Sizes<span></span></a></li>
<li class="chapter" data-level="9.7.3" data-path="mixed-effects-models.html"><a href="mixed-effects-models.html#pairwise-comparisons"><i class="fa fa-check"></i><b>9.7.3</b> Pairwise Comparisons<span></span></a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="mixed-effects-models.html"><a href="mixed-effects-models.html#exercises-8"><i class="fa fa-check"></i><b>9.8</b> Exercises<span></span></a>
<ul>
<li class="chapter" data-level="9.8.1" data-path="mixed-effects-models.html"><a href="mixed-effects-models.html#question-1-8"><i class="fa fa-check"></i><b>9.8.1</b> Question 1<span></span></a></li>
<li class="chapter" data-level="9.8.2" data-path="mixed-effects-models.html"><a href="mixed-effects-models.html#question-2-8"><i class="fa fa-check"></i><b>9.8.2</b> Question 2<span></span></a></li>
<li class="chapter" data-level="9.8.3" data-path="mixed-effects-models.html"><a href="mixed-effects-models.html#question-3-8"><i class="fa fa-check"></i><b>9.8.3</b> Question 3<span></span></a></li>
<li class="chapter" data-level="9.8.4" data-path="mixed-effects-models.html"><a href="mixed-effects-models.html#question-4-8"><i class="fa fa-check"></i><b>9.8.4</b> Question 4<span></span></a></li>
<li class="chapter" data-level="9.8.5" data-path="mixed-effects-models.html"><a href="mixed-effects-models.html#question-5-8"><i class="fa fa-check"></i><b>9.8.5</b> Question 5<span></span></a></li>
<li class="chapter" data-level="9.8.6" data-path="mixed-effects-models.html"><a href="mixed-effects-models.html#question-6-8"><i class="fa fa-check"></i><b>9.8.6</b> Question 6<span></span></a></li>
<li class="chapter" data-level="9.8.7" data-path="mixed-effects-models.html"><a href="mixed-effects-models.html#question-7-7"><i class="fa fa-check"></i><b>9.8.7</b> Question 7<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="reporting-reproducible-research.html"><a href="reporting-reproducible-research.html"><i class="fa fa-check"></i><b>10</b> Reporting Reproducible Research<span></span></a>
<ul>
<li class="chapter" data-level="10.1" data-path="reporting-reproducible-research.html"><a href="reporting-reproducible-research.html#getting-started-7"><i class="fa fa-check"></i><b>10.1</b> Getting Started<span></span></a></li>
<li class="chapter" data-level="10.2" data-path="reporting-reproducible-research.html"><a href="reporting-reproducible-research.html#creating-reproducible-documents"><i class="fa fa-check"></i><b>10.2</b> Creating Reproducible Documents<span></span></a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="reporting-reproducible-research.html"><a href="reporting-reproducible-research.html#creating-a-reproducible-report"><i class="fa fa-check"></i><b>10.2.1</b> Creating a Reproducible Report<span></span></a></li>
<li class="chapter" data-level="10.2.2" data-path="reporting-reproducible-research.html"><a href="reporting-reproducible-research.html#folder-structure-for-reproducible-analyses"><i class="fa fa-check"></i><b>10.2.2</b> Folder Structure for Reproducible Analyses<span></span></a></li>
<li class="chapter" data-level="10.2.3" data-path="reporting-reproducible-research.html"><a href="reporting-reproducible-research.html#using-r-markdown-templates"><i class="fa fa-check"></i><b>10.2.3</b> Using R Markdown Templates<span></span></a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="reporting-reproducible-research.html"><a href="reporting-reproducible-research.html#open-science"><i class="fa fa-check"></i><b>10.3</b> Open Science<span></span></a></li>
<li class="chapter" data-level="10.4" data-path="reporting-reproducible-research.html"><a href="reporting-reproducible-research.html#what-to-report"><i class="fa fa-check"></i><b>10.4</b> What to Report<span></span></a></li>
<li class="chapter" data-level="10.5" data-path="reporting-reproducible-research.html"><a href="reporting-reproducible-research.html#effect-sizes-1"><i class="fa fa-check"></i><b>10.5</b> Effect Sizes<span></span></a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="reporting-reproducible-research.html"><a href="reporting-reproducible-research.html#cohens-d-and-pearsons-r"><i class="fa fa-check"></i><b>10.5.1</b> Cohen’s d and Pearson’s r<span></span></a></li>
<li class="chapter" data-level="10.5.2" data-path="reporting-reproducible-research.html"><a href="reporting-reproducible-research.html#calculating-effect-sizes"><i class="fa fa-check"></i><b>10.5.2</b> Calculating Effect Sizes<span></span></a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="reporting-reproducible-research.html"><a href="reporting-reproducible-research.html#confidence-intervals"><i class="fa fa-check"></i><b>10.6</b> Confidence Intervals<span></span></a></li>
<li class="chapter" data-level="10.7" data-path="reporting-reproducible-research.html"><a href="reporting-reproducible-research.html#evaluating-evidence-for-the-null-hypothesis"><i class="fa fa-check"></i><b>10.7</b> Evaluating Evidence for the Null Hypothesis<span></span></a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="reporting-reproducible-research.html"><a href="reporting-reproducible-research.html#independent-samples-tost"><i class="fa fa-check"></i><b>10.7.1</b> Independent Samples TOST<span></span></a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="reporting-reproducible-research.html"><a href="reporting-reproducible-research.html#understanding-problematic-design-choices"><i class="fa fa-check"></i><b>10.8</b> Understanding Problematic Design Choices<span></span></a>
<ul>
<li class="chapter" data-level="10.8.1" data-path="reporting-reproducible-research.html"><a href="reporting-reproducible-research.html#optional-stopping-without-correction"><i class="fa fa-check"></i><b>10.8.1</b> Optional Stopping (Without Correction)<span></span></a></li>
<li class="chapter" data-level="10.8.2" data-path="reporting-reproducible-research.html"><a href="reporting-reproducible-research.html#bad-hypotheses"><i class="fa fa-check"></i><b>10.8.2</b> Bad Hypotheses<span></span></a></li>
</ul></li>
<li class="chapter" data-level="10.9" data-path="reporting-reproducible-research.html"><a href="reporting-reproducible-research.html#the-final-lesson"><i class="fa fa-check"></i><b>10.9</b> The Final Lesson<span></span></a></li>
<li class="chapter" data-level="10.10" data-path="reporting-reproducible-research.html"><a href="reporting-reproducible-research.html#exercises-9"><i class="fa fa-check"></i><b>10.10</b> Exercises<span></span></a>
<ul>
<li class="chapter" data-level="10.10.1" data-path="reporting-reproducible-research.html"><a href="reporting-reproducible-research.html#question-1-9"><i class="fa fa-check"></i><b>10.10.1</b> Question 1<span></span></a></li>
<li class="chapter" data-level="10.10.2" data-path="reporting-reproducible-research.html"><a href="reporting-reproducible-research.html#question-2-9"><i class="fa fa-check"></i><b>10.10.2</b> Question 2<span></span></a></li>
<li class="chapter" data-level="10.10.3" data-path="reporting-reproducible-research.html"><a href="reporting-reproducible-research.html#question-3-9"><i class="fa fa-check"></i><b>10.10.3</b> Question 3<span></span></a></li>
<li class="chapter" data-level="10.10.4" data-path="reporting-reproducible-research.html"><a href="reporting-reproducible-research.html#question-4-9"><i class="fa fa-check"></i><b>10.10.4</b> Question 4<span></span></a></li>
<li class="chapter" data-level="10.10.5" data-path="reporting-reproducible-research.html"><a href="reporting-reproducible-research.html#question-5-9"><i class="fa fa-check"></i><b>10.10.5</b> Question 5<span></span></a></li>
<li class="chapter" data-level="10.10.6" data-path="reporting-reproducible-research.html"><a href="reporting-reproducible-research.html#question-6-9"><i class="fa fa-check"></i><b>10.10.6</b> Question 6<span></span></a></li>
<li class="chapter" data-level="10.10.7" data-path="reporting-reproducible-research.html"><a href="reporting-reproducible-research.html#question-7-8"><i class="fa fa-check"></i><b>10.10.7</b> Question 7<span></span></a></li>
<li class="chapter" data-level="10.10.8" data-path="reporting-reproducible-research.html"><a href="reporting-reproducible-research.html#question-8-7"><i class="fa fa-check"></i><b>10.10.8</b> Question 8<span></span></a></li>
</ul></li>
</ul></li>
<li><a href="references.html#references">References<span></span></a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R for Psych</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="mixed-effects-models" class="section level1 hasAnchor" number="9">
<h1><span class="header-section-number">Chapter 9</span> Mixed Effects Models<a href="mixed-effects-models.html#mixed-effects-models" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In this session we’ll cover Linear/Hierarchical Mixed Effects Modelling. We’ll cover why you should use mixed effects modelling for your own analyses, how these models work, and how to define your models properly in R. Specifically, we’ll cover:</p>
<ul>
<li>Fixed and Random Effects</li>
<li>Random Intercepts and Slopes</li>
<li>Nested and Crossed Random Effects</li>
<li>Partial-Pooling of Data</li>
<li>Calculating <em>p</em>-values</li>
<li>Generalised Mixed Effects Models</li>
</ul>
<p>One nice introduction to mixed effects models is provided by Bodo Winter in two parts: <a href="http://www.bodowinter.com/tutorial/bw_LME_tutorial1.pdf">part one</a> and <a href="http://www.bodowinter.com/tutorial/bw_LME_tutorial2.pdf">part two</a> and you might want to check this out as further reading from this chapter.</p>
<div id="getting-started-6" class="section level2 hasAnchor" number="9.1">
<h2><span class="header-section-number">9.1</span> Getting Started<a href="mixed-effects-models.html#getting-started-6" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As always, we first need to load the <code>tidyverse</code> set of package. However, for this chapter we also need the <code>lme4</code> package. This package allows us to run mixed effects models in R using the <code>lmer</code> and <code>glmer</code> commands for linear mixed effects models and generalised linear mixed effects models respectively. These models are similar to linear models and generalised lienar models in that the first can take continuous, unbounded data, and the second takes bounded, discrete data.</p>
<div class="sourceCode" id="cb517"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb517-1"><a href="mixed-effects-models.html#cb517-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load packages</span></span>
<span id="cb517-2"><a href="mixed-effects-models.html#cb517-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb517-3"><a href="mixed-effects-models.html#cb517-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span></code></pre></div>
<p>Additionally, we’ll load the data set for this study. This is the inbuilt <code>sleepstudy</code> data set from <code>lme4</code>, but I’ve simulated 2 additional participants before removing a lot of their observations. This is to show you just how powerful mixed effects models are when we have missing data.</p>
</div>
<div id="why-mixed-effects-models" class="section level2 hasAnchor" number="9.2">
<h2><span class="header-section-number">9.2</span> Why Mixed Effects Models<a href="mixed-effects-models.html#why-mixed-effects-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In all of the previous analyses we’ve used so far, our models have assumed that we have independence between cases in our data. However, this assumption is often violated, which can cause some serious problems when it comes to interpreting our tests.</p>
<p>Let’s assume we’re interested in language learning in children from monolinguial and bilingual backgrounds. We may decide to test how well children learn an artificial language by going to several schools and testing children in the same year group from different classes.</p>
<p>If we fit a traditional linear model to our data, we implicitly make the assumption that learning should be the same regardless of the class or school the child attends. Yet we know this is unlikely to be true; schools reflect the demographics of an area and the school ethos, and individual teachers may be better or worse at teaching linguistics to children. This means that children within the same school are likely to be more similar to one another than to children from different schools. Moreover, children within the class are likely to be more similar to one another than to children in different classes. In this way, our data should be nested such that children should be defined as part of a specific class in a specific school, and our models should reflect this ordering.</p>
<p>With mixed effects models, we can directly model this dependency in our data. Moreover, mixed effects models make fewer strict assumptions to other tests (<span class="citation">Field, Miles, and Field (<a href="#ref-field2012discovering" role="doc-biblioref">2012</a>)</span>), such as:</p>
<ul>
<li><p>Homogeneity of regression slopes: Mixed effects models can directly model variability in slopes, so we needn’t make any assumption that slopes are similar across conditions (which is often untrue).</p></li>
<li><p>Assumption of independence: with independent-samples tests we often assume that data are unrelated to one-another. But again, this is often not the case; take learning over time. The same person provides multiple measurements at multiple time points. Mixed effects models can handle this well.</p></li>
<li><p>Complete data: Often, with traditional analyses you just have to throw away entire sources of data (e.g. participants) if one case (e.g. one trial) is missing. This isn’t the case with mixed effects models, where we can estimate missing data based on what we have available to us.</p></li>
</ul>
<p>For these reasons, by default you should probably pick mixed effects models to model your data.</p>
</div>
<div id="how-do-mixed-effects-models-work" class="section level2 hasAnchor" number="9.3">
<h2><span class="header-section-number">9.3</span> How Do Mixed Effects Models Work?<a href="mixed-effects-models.html#how-do-mixed-effects-models-work" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="fixed-and-random-effects" class="section level3 hasAnchor" number="9.3.1">
<h3><span class="header-section-number">9.3.1</span> Fixed and Random Effects<a href="mixed-effects-models.html#fixed-and-random-effects" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>So far, we’ve only talked about our parameter estimates from a linear model in terms of factors and levels. However, you can also consider the factors in your study in terms of whether they are fixed or random effects. Typically, a <strong>fixed effect</strong> will contain all possible levels of a factor in the experiment, while a <strong>random effect</strong> will be a random sample of possible levels of a factor. In effect, we can only generalise our fixed effects results to the levels within an experiment, but we can generalise from our random effects to levels beyond those that took part in our study.</p>
<p>Returning to our classroom example, if we tested languge learning in one of two conditions in students from different schools and and classes, our fixed effect would be the condition for the study. Hence, the random effects would be everything else we’d like to generalise to outside of our study. We probably want to generalise our results to all classes and all schools, so our random effects would be students within classes within schools.</p>
<p>In traditional models, you can say that all of the effects of interest, or the factors in the model, are defined as fixed effects. However, with mixed effects models, we can have both fixed and random effects in our model (hence <strong>mixed effects</strong> models).</p>
<p>To fit a mixed effects model, we simply define our fixed effects like we normally do for a linear model. However, there are different ways that we can define our random effects. Your choice of definition incorporates your belief of how the random effects work. Let’s explore how the way in which we define our random effects influences our model fit.</p>
<div id="fixed-intercept-and-slope" class="section level4 hasAnchor" number="9.3.1.1">
<h4><span class="header-section-number">9.3.1.1</span> Fixed Intercept and Slope<a href="mixed-effects-models.html#fixed-intercept-and-slope" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>To look at how mixed effects models work, we’ll use some toy data based on the <code>sleepstudy</code> data set from <strong>lme4</strong>. I made this quickly in another script, and you can load it using the code below.</p>
<p>This just makes three groups within our data, and we can look at this like conducting our study in three phases, with three different groups of people. As with the <code>sleepstudy</code> data set, this data set looks at the effect of days without sleep on reaction times.</p>
<div class="sourceCode" id="cb518"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb518-1"><a href="mixed-effects-models.html#cb518-1" aria-hidden="true" tabindex="-1"></a>sleep_groups <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;inputs/sleep_study_with_sim_groups.csv&quot;</span>)</span></code></pre></div>
<pre><code>## Rows: 540 Columns: 4
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## chr (1): Group
## dbl (3): Reaction, Days, Subject
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<p>If we were to fit this data to a traditional linear model, and we ignored the fact that we have a random effect in our study (Group), then our linear model coefficients might look like this:</p>
<div class="sourceCode" id="cb520"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb520-1"><a href="mixed-effects-models.html#cb520-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lm</span>(Reaction <span class="sc">~</span> Days, <span class="at">data =</span> sleep_groups)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = Reaction ~ Days, data = sleep_groups)
## 
## Coefficients:
## (Intercept)         Days  
##       371.7         15.4</code></pre>
<p>That is, we would get an intercept of approximately 351.5 and a slope of approximately 10.3 which is used to define the relationship for days on reaction times across all participants. This type of model looks against the raw data for the study looks like this:</p>
<div class="sourceCode" id="cb522"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb522-1"><a href="mixed-effects-models.html#cb522-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> sleep_groups, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Days, <span class="at">y =</span> Reaction)) <span class="sc">+</span></span>
<span id="cb522-2"><a href="mixed-effects-models.html#cb522-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">na.rm =</span> T, <span class="fu">aes</span>(<span class="at">col =</span> Group), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb522-3"><a href="mixed-effects-models.html#cb522-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">na.rm =</span> T, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">se =</span> F) <span class="sc">+</span></span>
<span id="cb522-4"><a href="mixed-effects-models.html#cb522-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">180</span>, <span class="dv">1020</span>)) <span class="sc">+</span></span>
<span id="cb522-5"><a href="mixed-effects-models.html#cb522-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb522-6"><a href="mixed-effects-models.html#cb522-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>)</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="R-for-Psych_files/figure-html/plot-lm-reaction-days-1.png" width="672" /></p>
<p>But, you can see from the colour of the points that we have 3 distinct groups of participants in our model. It’s clear that the three groups have different intercepts, and group 3 has a much steeper slope than the other two groups. Perhaps, then, we should model this difference across groups, even if it’s not the main factor of interest in our study.</p>
</div>
<div id="random-intercepts" class="section level4 hasAnchor" number="9.3.1.2">
<h4><span class="header-section-number">9.3.1.2</span> Random Intercepts<a href="mixed-effects-models.html#random-intercepts" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We define a mixed effects model in a similar way to a traditional linear model. Here, the only difference is we run the model using the <code>lmer()</code> function from <strong>lme4</strong>, rather than the <code>lm()</code> function from base R, and we specify our random effects as well.</p>
<div class="sourceCode" id="cb524"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb524-1"><a href="mixed-effects-models.html#cb524-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit random intercepts model</span></span>
<span id="cb524-2"><a href="mixed-effects-models.html#cb524-2" aria-hidden="true" tabindex="-1"></a>intercepts_model <span class="ot">&lt;-</span> <span class="fu">lmer</span>(Reaction <span class="sc">~</span> Days <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Group), <span class="at">data =</span> sleep_groups)</span></code></pre></div>
<p>As with regular linear models, we define our response variable as the column name to the left of the <code>~</code> (read: tilde). We then define our fixed effects to the right of the <code>~</code>.</p>
<p>After this, we define our random effects in parentheses. Here, we have specified that we want <strong>random intercept (1)</strong> for each group; <code>(1 | Group)</code>. Notice that we have a <code>|</code> (read: pipe) between the 1 and group. This specifies what you want to calculate, by which random factor - here it is random intercepts (1) by the Group random factor.</p>
<p>Finally, as always we specify our data set, which should be in long format.</p>
<p>Let’s see how defining random intercepts affects the coefficients for the groups in our model. We can extract model coefficients using the <code>coef()</code> function. I specifically got the Group coefficients by asking for this using the dollar notation after the function call. To make this easier on the eyes I’ve renamed the columns, and created an identifier for the intercepts and slopes (i.e. the Group column).</p>
<div class="sourceCode" id="cb525"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb525-1"><a href="mixed-effects-models.html#cb525-1" aria-hidden="true" tabindex="-1"></a><span class="co"># see group coefficients</span></span>
<span id="cb525-2"><a href="mixed-effects-models.html#cb525-2" aria-hidden="true" tabindex="-1"></a>model_coefs <span class="ot">&lt;-</span> <span class="fu">coef</span>(intercepts_model)<span class="sc">$</span>Group <span class="sc">%&gt;%</span> </span>
<span id="cb525-3"><a href="mixed-effects-models.html#cb525-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Intercept =</span> <span class="st">`</span><span class="at">(Intercept)</span><span class="st">`</span>, <span class="at">Slope =</span> Days) <span class="sc">%&gt;%</span> </span>
<span id="cb525-4"><a href="mixed-effects-models.html#cb525-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">&quot;Group&quot;</span>)</span>
<span id="cb525-5"><a href="mixed-effects-models.html#cb525-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb525-6"><a href="mixed-effects-models.html#cb525-6" aria-hidden="true" tabindex="-1"></a><span class="co"># see coefficients</span></span>
<span id="cb525-7"><a href="mixed-effects-models.html#cb525-7" aria-hidden="true" tabindex="-1"></a>model_coefs</span></code></pre></div>
<pre><code>##     Group Intercept    Slope
## 1 group_1  229.3394 15.40385
## 2 group_2  329.0908 15.40385
## 3 group_3  556.6432 15.40385</code></pre>
<p>How would this model look against our raw data?</p>
<p>First, we’ll join these coefficients to our original data so we can plot the individual lines.</p>
<div class="sourceCode" id="cb527"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb527-1"><a href="mixed-effects-models.html#cb527-1" aria-hidden="true" tabindex="-1"></a>sleep_groups_rani <span class="ot">&lt;-</span> <span class="fu">left_join</span>(sleep_groups, model_coefs, <span class="at">by =</span> <span class="st">&quot;Group&quot;</span>)</span></code></pre></div>
<p>Then we’ll plot our original data with our new, random intercepts model. We’ll save this under the name <code>model_coef_plot</code> because we can use a simple ggplot function to update models without repeating code.</p>
<div class="sourceCode" id="cb528"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb528-1"><a href="mixed-effects-models.html#cb528-1" aria-hidden="true" tabindex="-1"></a>model_coef_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> sleep_groups_rani, </span>
<span id="cb528-2"><a href="mixed-effects-models.html#cb528-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Days, </span>
<span id="cb528-3"><a href="mixed-effects-models.html#cb528-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> Reaction, </span>
<span id="cb528-4"><a href="mixed-effects-models.html#cb528-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">colour =</span> Group)</span>
<span id="cb528-5"><a href="mixed-effects-models.html#cb528-5" aria-hidden="true" tabindex="-1"></a>       ) <span class="sc">+</span></span>
<span id="cb528-6"><a href="mixed-effects-models.html#cb528-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">na.rm =</span> T, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb528-7"><a href="mixed-effects-models.html#cb528-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">intercept =</span> Intercept, </span>
<span id="cb528-8"><a href="mixed-effects-models.html#cb528-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">slope =</span> Slope,</span>
<span id="cb528-9"><a href="mixed-effects-models.html#cb528-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">colour =</span> Group</span>
<span id="cb528-10"><a href="mixed-effects-models.html#cb528-10" aria-hidden="true" tabindex="-1"></a>                  ),</span>
<span id="cb528-11"><a href="mixed-effects-models.html#cb528-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="fl">1.5</span></span>
<span id="cb528-12"><a href="mixed-effects-models.html#cb528-12" aria-hidden="true" tabindex="-1"></a>              ) <span class="sc">+</span></span>
<span id="cb528-13"><a href="mixed-effects-models.html#cb528-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">180</span>, <span class="dv">1020</span>)) <span class="sc">+</span></span>
<span id="cb528-14"><a href="mixed-effects-models.html#cb528-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb528-15"><a href="mixed-effects-models.html#cb528-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;top&quot;</span>)</span>
<span id="cb528-16"><a href="mixed-effects-models.html#cb528-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb528-17"><a href="mixed-effects-models.html#cb528-17" aria-hidden="true" tabindex="-1"></a><span class="co"># see the plot</span></span>
<span id="cb528-18"><a href="mixed-effects-models.html#cb528-18" aria-hidden="true" tabindex="-1"></a>model_coef_plot</span></code></pre></div>
<p><img src="R-for-Psych_files/figure-html/plot-random-intercepts-1.png" width="672" /></p>
<p>Now you can see that we fit a model where the intercept (the y value at x = 0) differs across the 3 groups, but the slope of the lines is the same.</p>
<p>You might pick a random effects structure with random intercepts for data like this if you expect the three groups to differ from one another at the start of testing, but the effect of days on reaction times is the same across groups.</p>
</div>
<div id="random-slopes" class="section level4 hasAnchor" number="9.3.1.3">
<h4><span class="header-section-number">9.3.1.3</span> Random Slopes<a href="mixed-effects-models.html#random-slopes" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Alternatively, we can specify a random effects structure with random slopes but fixed intercepts. We might pick this form if we expect all groups to start off at around the same score, but that the effects of days on reaction times differs across groups.</p>
<p>To specify this random effects structure, we change the 1 to a 0 in our random effects structure (specifying no or 0 random intercepts) and we put Days to the left of the <code>|</code>, meaning that we want to calculate random slopes for the effect of Days for each Group.</p>
<div class="sourceCode" id="cb529"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb529-1"><a href="mixed-effects-models.html#cb529-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit random slopes model</span></span>
<span id="cb529-2"><a href="mixed-effects-models.html#cb529-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lmer</span>(Reaction <span class="sc">~</span> Days <span class="sc">+</span> (<span class="dv">0</span> <span class="sc">+</span> Days <span class="sc">|</span> Group), <span class="at">data =</span> sleep_groups)</span>
<span id="cb529-3"><a href="mixed-effects-models.html#cb529-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb529-4"><a href="mixed-effects-models.html#cb529-4" aria-hidden="true" tabindex="-1"></a><span class="co"># see group coefficients</span></span>
<span id="cb529-5"><a href="mixed-effects-models.html#cb529-5" aria-hidden="true" tabindex="-1"></a>model_coefs <span class="ot">&lt;-</span> <span class="fu">coef</span>(model)<span class="sc">$</span>Group <span class="sc">%&gt;%</span> </span>
<span id="cb529-6"><a href="mixed-effects-models.html#cb529-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Intercept =</span> <span class="st">`</span><span class="at">(Intercept)</span><span class="st">`</span>, <span class="at">Slope =</span> Days) <span class="sc">%&gt;%</span> </span>
<span id="cb529-7"><a href="mixed-effects-models.html#cb529-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">&quot;Group&quot;</span>)</span>
<span id="cb529-8"><a href="mixed-effects-models.html#cb529-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb529-9"><a href="mixed-effects-models.html#cb529-9" aria-hidden="true" tabindex="-1"></a><span class="co"># see coefficients</span></span>
<span id="cb529-10"><a href="mixed-effects-models.html#cb529-10" aria-hidden="true" tabindex="-1"></a>model_coefs</span></code></pre></div>
<pre><code>##     Group Intercept     Slope
## 1 group_1  371.6912 -8.479087
## 2 group_2  371.6912  7.249332
## 3 group_3  371.6912 47.441298</code></pre>
<p>Next, we’ll join these coefficients to our original data.</p>
<div class="sourceCode" id="cb531"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb531-1"><a href="mixed-effects-models.html#cb531-1" aria-hidden="true" tabindex="-1"></a>sleep_groups_rans <span class="ot">&lt;-</span> <span class="fu">left_join</span>(sleep_groups, model_coefs, <span class="at">by =</span> <span class="st">&quot;Group&quot;</span>)</span></code></pre></div>
<p>Then we’ll plot our original data with our new, random intercepts model. Here, we’ll use a new, cheat function from ggplot, <code>%+%</code> (read: add components). This takes a fitted plot from ggplot, and replaces the data from that plot with whatever comes to the right of the function.</p>
<div class="sourceCode" id="cb532"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb532-1"><a href="mixed-effects-models.html#cb532-1" aria-hidden="true" tabindex="-1"></a>model_coef_plot <span class="sc">%+%</span> sleep_groups_rans</span></code></pre></div>
<p><img src="R-for-Psych_files/figure-html/plot-random-slopes-1.png" width="672" /></p>
<p>In the above plot, we can now see that our data has the same intercept across groups, but different slopes. It seems that the effect of days without sleep is greatest for group 3.</p>
</div>
<div id="random-intercepts-and-slopes" class="section level4 hasAnchor" number="9.3.1.4">
<h4><span class="header-section-number">9.3.1.4</span> Random Intercepts and Slopes<a href="mixed-effects-models.html#random-intercepts-and-slopes" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Finally, we can specify that we want random intercepts and slopes for the group. Here, we just change the 0 back to a 1 in the random effects call.</p>
<div class="sourceCode" id="cb533"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb533-1"><a href="mixed-effects-models.html#cb533-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit random intercepts model</span></span>
<span id="cb533-2"><a href="mixed-effects-models.html#cb533-2" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lmer</span>(Reaction <span class="sc">~</span> Days <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> Days <span class="sc">|</span> Group), <span class="at">data =</span> sleep_groups)</span></code></pre></div>
<pre><code>## Warning in checkConv(attr(opt, &quot;derivs&quot;), opt$par, ctrl = control$checkConv, :
## Model failed to converge with max|grad| = 0.00268565 (tol = 0.002, component 1)</code></pre>
<p>Let’s see how these coefficients look.</p>
<div class="sourceCode" id="cb535"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb535-1"><a href="mixed-effects-models.html#cb535-1" aria-hidden="true" tabindex="-1"></a><span class="co"># see group coefficients</span></span>
<span id="cb535-2"><a href="mixed-effects-models.html#cb535-2" aria-hidden="true" tabindex="-1"></a>model_coefs <span class="ot">&lt;-</span> <span class="fu">coef</span>(model)<span class="sc">$</span>Group <span class="sc">%&gt;%</span> </span>
<span id="cb535-3"><a href="mixed-effects-models.html#cb535-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Intercept =</span> <span class="st">`</span><span class="at">(Intercept)</span><span class="st">`</span>, <span class="at">Slope =</span> Days) <span class="sc">%&gt;%</span> </span>
<span id="cb535-4"><a href="mixed-effects-models.html#cb535-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="st">&quot;Group&quot;</span>)</span>
<span id="cb535-5"><a href="mixed-effects-models.html#cb535-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb535-6"><a href="mixed-effects-models.html#cb535-6" aria-hidden="true" tabindex="-1"></a><span class="co"># see coefficients</span></span>
<span id="cb535-7"><a href="mixed-effects-models.html#cb535-7" aria-hidden="true" tabindex="-1"></a>model_coefs</span></code></pre></div>
<pre><code>##     Group Intercept     Slope
## 1 group_1  256.4951  9.457048
## 2 group_2  344.2963 11.894270
## 3 group_3  514.2821 24.860226</code></pre>
<p>Next, we’ll join these coefficients to our original data.</p>
<div class="sourceCode" id="cb537"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb537-1"><a href="mixed-effects-models.html#cb537-1" aria-hidden="true" tabindex="-1"></a>sleep_groups_ranis <span class="ot">&lt;-</span> <span class="fu">left_join</span>(sleep_groups, model_coefs, <span class="at">by =</span> <span class="st">&quot;Group&quot;</span>)</span></code></pre></div>
<p>Then we’ll plot our original data with our new, random intercepts and random slopes model.</p>
<div class="sourceCode" id="cb538"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb538-1"><a href="mixed-effects-models.html#cb538-1" aria-hidden="true" tabindex="-1"></a>model_coef_plot <span class="sc">%+%</span> sleep_groups_ranis</span></code></pre></div>
<p><img src="R-for-Psych_files/figure-html/plot-random-intercepts-and-slopes-1.png" width="672" /></p>
<p>As you can see, our model now fits random intercepts and slopes for each group of our participants.</p>
</div>
</div>
<div id="specifying-your-random-effects-structure" class="section level3 hasAnchor" number="9.3.2">
<h3><span class="header-section-number">9.3.2</span> Specifying your Random Effects Structure<a href="mixed-effects-models.html#specifying-your-random-effects-structure" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There’s some debate on how to specify your random effects, but one good rule of thumb is to <a href="https://www.sciencedirect.com/science/article/pii/S0749596X12001180">keep it maximal</a>. From several simulations, Dale Barr and colleagues have found that models that use the maximal random effects structure justified by the design of the study tend to have a good balance between power and type-I error rates (specifically keeping error below the nominal <span class="math inline">\(\alpha\)</span>).</p>
<p>What does a maximal random effect structure look like? Typically, it will fit random intercepts, slopes, and the correlation between the two for any main effects and interactions in the model.</p>
<p><a href="https://www.sciencedirect.com/science/article/pii/S0749596X17300013">Not all researchers agree that this is always the best choice</a>. Indeed, some argue that you should evaluate the goodness of fit for models with and without more complex terms in the model (such as random slopes and interactions) in order to get the best trade off between power and type-I error rates, especially at smaller sample sizes, and that maximal models inflate type-II error rates. The choice is up to you, but be informed about the choice you make.</p>
<div id="crossed-and-nested-random-effects" class="section level4 hasAnchor" number="9.3.2.1">
<h4><span class="header-section-number">9.3.2.1</span> Crossed and Nested Random Effects<a href="mixed-effects-models.html#crossed-and-nested-random-effects" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>To understand how to define your random effects, we’ll look at some more simulated data. For illustration purposes, we won’t fit these models (we’d really need more data for that), but just pay attention to the structure of the models.</p>
<div id="crossed-random-effects" class="section level5 hasAnchor" number="9.3.2.1.1">
<h5><span class="header-section-number">9.3.2.1.1</span> Crossed Random Effects<a href="mixed-effects-models.html#crossed-random-effects" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>The random effects structure that you take should reflect the reality of the data. If you have a design where observations can be assigned to more than one random effect simultaneously, then these random effects are said to be crossed.</p>
<p>This is often the case when you have a repeated measures design where participants provide multiple observations through responding to several items. In this instance, each observation comes from an individual subject on an individual item at the same time, making each observation a unique combination of these random factors. Hence, the random effects of subjects and items are said to be crossed.</p>
<p>For this example, our data could look like the following:</p>
<div class="sourceCode" id="cb539"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb539-1"><a href="mixed-effects-models.html#cb539-1" aria-hidden="true" tabindex="-1"></a>crossed_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb539-2"><a href="mixed-effects-models.html#cb539-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Subject =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="dv">5</span>),</span>
<span id="cb539-3"><a href="mixed-effects-models.html#cb539-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Item =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">each =</span> <span class="dv">2</span>),</span>
<span id="cb539-4"><a href="mixed-effects-models.html#cb539-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Condition =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>), <span class="dv">2</span>), <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;B&quot;</span>, <span class="st">&quot;A&quot;</span>), <span class="dv">3</span>)),</span>
<span id="cb539-5"><a href="mixed-effects-models.html#cb539-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Response =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">10</span>, <span class="at">mean =</span> <span class="dv">100</span>, <span class="at">sd =</span> <span class="dv">10</span>)</span>
<span id="cb539-6"><a href="mixed-effects-models.html#cb539-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb539-7"><a href="mixed-effects-models.html#cb539-7" aria-hidden="true" tabindex="-1"></a>crossed_data</span></code></pre></div>
<pre><code>## # A tibble: 10 × 4
##    Subject  Item Condition Response
##      &lt;int&gt; &lt;int&gt; &lt;chr&gt;        &lt;dbl&gt;
##  1       1     1 A             92.8
##  2       2     1 B             85.0
##  3       1     2 A            108. 
##  4       2     2 B            109. 
##  5       1     3 B            100. 
##  6       2     3 A            106. 
##  7       1     4 B             92.8
##  8       2     4 A            111. 
##  9       1     5 B            118. 
## 10       2     5 A            105.</code></pre>
<p>Here, both participants take part in both conditions (A or B), hence this is a within-subjects design (but note that this dummy set is not balanced; real designs should be where possible). The condition (A or B) is therefore within individual subjects and individual items, but items are not only associated with one subject. Hence, our random effects are crossed, and should look like this:</p>
<div class="sourceCode" id="cb541"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb541-1"><a href="mixed-effects-models.html#cb541-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lmer</span>(Response <span class="sc">~</span> Condition <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Subject) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Item), <span class="at">data =</span> crossed_data)</span></code></pre></div>
</div>
<div id="nested-random-effects" class="section level5 hasAnchor" number="9.3.2.1.2">
<h5><span class="header-section-number">9.3.2.1.2</span> Nested Random Effects<a href="mixed-effects-models.html#nested-random-effects" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Sometimes we get cases when our data are not crossed. For example, if you’re testing participants from separate classes in separate schools, then your data can be said to be nested. The data are nested because observations come from students, which are a part of a specific class, and a specific school. In this instance, you should construct your data to reflect this nesting, ending up with something like this:</p>
<div class="sourceCode" id="cb542"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb542-1"><a href="mixed-effects-models.html#cb542-1" aria-hidden="true" tabindex="-1"></a>nested_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb542-2"><a href="mixed-effects-models.html#cb542-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Student =</span> <span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>),</span>
<span id="cb542-3"><a href="mixed-effects-models.html#cb542-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Class =</span> <span class="fu">rep</span>(<span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>), <span class="dv">2</span>),</span>
<span id="cb542-4"><a href="mixed-effects-models.html#cb542-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">School =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">5</span>), <span class="fu">rep</span>(<span class="dv">2</span>, <span class="dv">5</span>)),</span>
<span id="cb542-5"><a href="mixed-effects-models.html#cb542-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Intervention =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;yes&quot;</span>, <span class="st">&quot;no&quot;</span>), <span class="dv">5</span>),</span>
<span id="cb542-6"><a href="mixed-effects-models.html#cb542-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Outcome =</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">10</span>, <span class="at">mean =</span> <span class="dv">200</span>, <span class="at">sd =</span> <span class="dv">20</span>)</span>
<span id="cb542-7"><a href="mixed-effects-models.html#cb542-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb542-8"><a href="mixed-effects-models.html#cb542-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb542-9"><a href="mixed-effects-models.html#cb542-9" aria-hidden="true" tabindex="-1"></a>nested_data</span></code></pre></div>
<pre><code>## # A tibble: 10 × 5
##    Student Class School Intervention Outcome
##      &lt;int&gt; &lt;int&gt;  &lt;dbl&gt; &lt;chr&gt;          &lt;dbl&gt;
##  1       1     1      1 yes             195.
##  2       2     2      1 no              191.
##  3       3     3      1 yes             184.
##  4       4     4      1 no              169.
##  5       5     5      1 yes             249.
##  6       6     1      2 no              232.
##  7       7     2      2 yes             224.
##  8       8     3      2 no              199.
##  9       9     4      2 yes             170.
## 10      10     5      2 no              171.</code></pre>
<p>As you can see, your data are structured so that you have individuals with an identifier (column) for the class that they’re in and for the school that they’re in. We then have a column indicating whether or not students received an intervention, and their outcome on some test.</p>
<p>As a result, class 1 in school 1 is different to class 1 in school 2. How do you tell R to treat the data such that classes are nested within schools? Or to account for the school and class effects for each participant? We use a formula like this:</p>
<div class="sourceCode" id="cb544"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb544-1"><a href="mixed-effects-models.html#cb544-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lmer</span>(Outcome <span class="sc">~</span> Intervention <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> School<span class="sc">/</span>Class<span class="sc">/</span>Student), <span class="at">data =</span> nested_data)</span></code></pre></div>
<p>Here, our random effects structure defines random intercepts for students, adjusting for similarities for students within the same class and school.</p>
<p>It’s sometimes hard to figure out if you have nested or crossed (i.e. not nested) data, and you can help your thinking (and Rs functioning) by simply using unique class identifiers for your school and class combinations. We can make this by simply pasting the identifiers for the School and Class together.</p>
<div class="sourceCode" id="cb545"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb545-1"><a href="mixed-effects-models.html#cb545-1" aria-hidden="true" tabindex="-1"></a>nested_data<span class="sc">$</span>Class_ID <span class="ot">&lt;-</span> <span class="fu">paste</span>(nested_data<span class="sc">$</span>School, nested_data<span class="sc">$</span>Class, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>)</span>
<span id="cb545-2"><a href="mixed-effects-models.html#cb545-2" aria-hidden="true" tabindex="-1"></a>nested_data</span></code></pre></div>
<pre><code>## # A tibble: 10 × 6
##    Student Class School Intervention Outcome Class_ID
##      &lt;int&gt; &lt;int&gt;  &lt;dbl&gt; &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;   
##  1       1     1      1 yes             195. 1_1     
##  2       2     2      1 no              191. 1_2     
##  3       3     3      1 yes             184. 1_3     
##  4       4     4      1 no              169. 1_4     
##  5       5     5      1 yes             249. 1_5     
##  6       6     1      2 no              232. 2_1     
##  7       7     2      2 yes             224. 2_2     
##  8       8     3      2 no              199. 2_3     
##  9       9     4      2 yes             170. 2_4     
## 10      10     5      2 no              171. 2_5</code></pre>
<p>Now your results will be exactly the same if you use either of these two formulas:</p>
<div class="sourceCode" id="cb547"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb547-1"><a href="mixed-effects-models.html#cb547-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lmer</span>(Outcome <span class="sc">~</span> Intervention <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> School<span class="sc">/</span>Class_ID), <span class="at">data =</span> nested_data)</span>
<span id="cb547-2"><a href="mixed-effects-models.html#cb547-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lmer</span>(Outcome <span class="sc">~</span> Intervention <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> School) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Class_ID), <span class="at">data =</span> nested_data)</span></code></pre></div>
<p>If you don’t have unique identifiers, using this second structure will give you incorrect results as R will think that every class was in every school, which is not the case.</p>
<p>These random effects structures take the simplest form where we have random intercepts only. In most cases, it’s best to fit a more complex model depending upon the data you have.</p>
</div>
</div>
<div id="exploring-different-random-effects-structres" class="section level4 hasAnchor" number="9.3.2.2">
<h4><span class="header-section-number">9.3.2.2</span> Exploring Different Random Effects Structres<a href="mixed-effects-models.html#exploring-different-random-effects-structres" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Let’s say we have a within subjects design, where participants see half of the items in our study in one condition, and half in another condition. Let’s take the <code>crossed_data</code> example from before.</p>
<div class="sourceCode" id="cb548"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb548-1"><a href="mixed-effects-models.html#cb548-1" aria-hidden="true" tabindex="-1"></a>crossed_data</span></code></pre></div>
<pre><code>## # A tibble: 10 × 4
##    Subject  Item Condition Response
##      &lt;int&gt; &lt;int&gt; &lt;chr&gt;        &lt;dbl&gt;
##  1       1     1 A             92.8
##  2       2     1 B             85.0
##  3       1     2 A            108. 
##  4       2     2 B            109. 
##  5       1     3 B            100. 
##  6       2     3 A            106. 
##  7       1     4 B             92.8
##  8       2     4 A            111. 
##  9       1     5 B            118. 
## 10       2     5 A            105.</code></pre>
<p>Here, we could fit random intercepts and slopes for subjects and items by adding condition (our slope term, or change in response for changes in 1 unit of condition) to the left of each term (along with the random intercept).</p>
<div class="sourceCode" id="cb550"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb550-1"><a href="mixed-effects-models.html#cb550-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lmer</span>(Outcome <span class="sc">~</span> Condition <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> Condition <span class="sc">|</span> Subject) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> Condition <span class="sc">|</span> Item), <span class="at">data =</span> data)</span></code></pre></div>
<p>What if participants take part in several blocks of this study? We might expect that their performance will improve from block to block. Here, we’d just have to add a fixed effect of study block and random effects on any factors that are affected by the blocking. If you repeat your items across blocks with the same subjects, you’d have random effects of block on subjects and items (along with condition). If you have new items in each block, you’d only have random slopes of block for subjects. These random effects structures look like this:</p>
<div class="sourceCode" id="cb551"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb551-1"><a href="mixed-effects-models.html#cb551-1" aria-hidden="true" tabindex="-1"></a><span class="co"># same items within each block</span></span>
<span id="cb551-2"><a href="mixed-effects-models.html#cb551-2" aria-hidden="true" tabindex="-1"></a><span class="fu">lmer</span>(</span>
<span id="cb551-3"><a href="mixed-effects-models.html#cb551-3" aria-hidden="true" tabindex="-1"></a>  Outcome <span class="sc">~</span> Condition <span class="sc">+</span> Block <span class="sc">+</span> </span>
<span id="cb551-4"><a href="mixed-effects-models.html#cb551-4" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">+</span> Condition <span class="sc">+</span> Block <span class="sc">|</span> Subject) <span class="sc">+</span> </span>
<span id="cb551-5"><a href="mixed-effects-models.html#cb551-5" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">+</span> Condition <span class="sc">+</span> Block <span class="sc">|</span> Item), </span>
<span id="cb551-6"><a href="mixed-effects-models.html#cb551-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data</span>
<span id="cb551-7"><a href="mixed-effects-models.html#cb551-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb551-8"><a href="mixed-effects-models.html#cb551-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb551-9"><a href="mixed-effects-models.html#cb551-9" aria-hidden="true" tabindex="-1"></a><span class="co"># new items within each block</span></span>
<span id="cb551-10"><a href="mixed-effects-models.html#cb551-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lmer</span>(</span>
<span id="cb551-11"><a href="mixed-effects-models.html#cb551-11" aria-hidden="true" tabindex="-1"></a>  Outcome <span class="sc">~</span> Condition <span class="sc">+</span> Block <span class="sc">+</span> </span>
<span id="cb551-12"><a href="mixed-effects-models.html#cb551-12" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">+</span> Condition <span class="sc">+</span> Block <span class="sc">|</span> Subject) <span class="sc">+</span> </span>
<span id="cb551-13"><a href="mixed-effects-models.html#cb551-13" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">+</span> Condition <span class="sc">|</span> Item), </span>
<span id="cb551-14"><a href="mixed-effects-models.html#cb551-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data</span>
<span id="cb551-15"><a href="mixed-effects-models.html#cb551-15" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p>As you might have guessed, for any between subjects factors, we cannot have a random slope of condition for that factor for each subject as subjects only see one condition. Here, our model might look like this:</p>
<div class="sourceCode" id="cb552"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb552-1"><a href="mixed-effects-models.html#cb552-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lmer</span>(</span>
<span id="cb552-2"><a href="mixed-effects-models.html#cb552-2" aria-hidden="true" tabindex="-1"></a>  Outcome <span class="sc">~</span> Condition <span class="sc">+</span> </span>
<span id="cb552-3"><a href="mixed-effects-models.html#cb552-3" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">|</span> Subject) <span class="sc">+</span> </span>
<span id="cb552-4"><a href="mixed-effects-models.html#cb552-4" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">+</span> Condition <span class="sc">|</span> Item), </span>
<span id="cb552-5"><a href="mixed-effects-models.html#cb552-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data</span>
<span id="cb552-6"><a href="mixed-effects-models.html#cb552-6" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p>Where we can have random slopes for condition by item (as all items presumably see all conditions), but only random intercepts for subjects as they only see one condition.</p>
<p>Finally, as with all linear models, if we want an interaction between factors, we simply use an asterisk between factors to define our interactions, or a colon if we only want the interaction term and not main effects. This could take the form below if we want random intercepts and slopes for both factors on subjects and items, with main effects and interactions on our fixed factors.</p>
<div class="sourceCode" id="cb553"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb553-1"><a href="mixed-effects-models.html#cb553-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lmer</span>(</span>
<span id="cb553-2"><a href="mixed-effects-models.html#cb553-2" aria-hidden="true" tabindex="-1"></a>  Outcome <span class="sc">~</span> factor_A <span class="sc">*</span> factor_B <span class="sc">+</span> </span>
<span id="cb553-3"><a href="mixed-effects-models.html#cb553-3" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">+</span> factor_A <span class="sc">*</span> factor_B <span class="sc">|</span> Subject) <span class="sc">+</span> </span>
<span id="cb553-4"><a href="mixed-effects-models.html#cb553-4" aria-hidden="true" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">+</span> factor_A <span class="sc">*</span> factor_B <span class="sc">|</span> Item), </span>
<span id="cb553-5"><a href="mixed-effects-models.html#cb553-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data</span>
<span id="cb553-6"><a href="mixed-effects-models.html#cb553-6" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p>If you’d like to find out more about different structures, <a href="http://rpsychologist.com/r-guide-longitudinal-lme-lmer">Kristoffer Magnusson has a great guide</a> on this.</p>
</div>
</div>
<div id="partial-pooling-of-data" class="section level3 hasAnchor" number="9.3.3">
<h3><span class="header-section-number">9.3.3</span> Partial-Pooling of Data<a href="mixed-effects-models.html#partial-pooling-of-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Here, we’ll follow the first part of <a href="https://tjmahr.github.io/plotting-partial-pooling-in-mixed-effects-models/">TJ Mahr’s excellent write up</a> of partial-pooling, and why this is so important for mixed effects models. Additionally, we’ll see how partial-pooling allows mixed effects models to account for missing data.</p>
<p>We’ll use the same data set as in TJ’s article, the <code>sleepstudy</code> data set from the <code>lme4</code> package. I’ve already made some changes to this data set by convering it to a tibble and adding a few participants with missing data at the end by simulating new values based on the old participants, and simply deleting a few cells. Load the .csv file from the lesson materials folder to take a look at the data.</p>
<div class="sourceCode" id="cb554"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb554-1"><a href="mixed-effects-models.html#cb554-1" aria-hidden="true" tabindex="-1"></a>sleep_study <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;inputs/sleep_study_with_sim.csv&quot;</span>)</span></code></pre></div>
<pre><code>## Rows: 210 Columns: 3
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## dbl (3): Subject, Days, Reaction
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<p>First off, we’ll fit a linear model to the data using complete pooling. This means that all of our data from each participant is put together to come up with one mean intercept and slope which is the same across all participants.</p>
<div class="sourceCode" id="cb556"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb556-1"><a href="mixed-effects-models.html#cb556-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit model</span></span>
<span id="cb556-2"><a href="mixed-effects-models.html#cb556-2" aria-hidden="true" tabindex="-1"></a>complete_pooling <span class="ot">&lt;-</span> <span class="fu">lm</span>(Reaction <span class="sc">~</span> Days, <span class="at">data =</span> sleep_study)</span>
<span id="cb556-3"><a href="mixed-effects-models.html#cb556-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb556-4"><a href="mixed-effects-models.html#cb556-4" aria-hidden="true" tabindex="-1"></a><span class="co"># tidy up and print model coefficients</span></span>
<span id="cb556-5"><a href="mixed-effects-models.html#cb556-5" aria-hidden="true" tabindex="-1"></a>complete_pooling_coefs <span class="ot">&lt;-</span> <span class="fu">coef</span>(complete_pooling)</span>
<span id="cb556-6"><a href="mixed-effects-models.html#cb556-6" aria-hidden="true" tabindex="-1"></a>complete_pooling_coefs</span></code></pre></div>
<pre><code>## (Intercept)        Days 
##   252.09397    10.03451</code></pre>
<p>Next, we’ll fit this model against our mean scores (with standard errors), observing how an increase in the days without sleep decreases reaction time.</p>
<div class="sourceCode" id="cb558"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb558-1"><a href="mixed-effects-models.html#cb558-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> sleep_study, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Days, <span class="at">y =</span> Reaction)) <span class="sc">+</span></span>
<span id="cb558-2"><a href="mixed-effects-models.html#cb558-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">intercept =</span> complete_pooling_coefs[<span class="dv">1</span>], </span>
<span id="cb558-3"><a href="mixed-effects-models.html#cb558-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">slope =</span> complete_pooling_coefs[<span class="dv">2</span>]</span>
<span id="cb558-4"><a href="mixed-effects-models.html#cb558-4" aria-hidden="true" tabindex="-1"></a>                  ),</span>
<span id="cb558-5"><a href="mixed-effects-models.html#cb558-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">colour =</span> <span class="st">&quot;#F8766D&quot;</span>,</span>
<span id="cb558-6"><a href="mixed-effects-models.html#cb558-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="fl">1.5</span></span>
<span id="cb558-7"><a href="mixed-effects-models.html#cb558-7" aria-hidden="true" tabindex="-1"></a>              ) <span class="sc">+</span></span>
<span id="cb558-8"><a href="mixed-effects-models.html#cb558-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.data =</span> <span class="st">&quot;mean_se&quot;</span>, </span>
<span id="cb558-9"><a href="mixed-effects-models.html#cb558-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">&quot;pointrange&quot;</span>,</span>
<span id="cb558-10"><a href="mixed-effects-models.html#cb558-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">na.rm =</span> T,</span>
<span id="cb558-11"><a href="mixed-effects-models.html#cb558-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">colour =</span> <span class="st">&quot;#F8766D&quot;</span>)</span></code></pre></div>
<p><img src="R-for-Psych_files/figure-html/plot-complete-pooling-1.png" width="672" /></p>
<p>You can see that this line fits the mean scores pretty well. But how does the data look at the individual level? Again, we’ll save this plot as an object so we can update it later on. We’ll also join these coefficients with our data so that we can easily update our plot when we explore different pooling choices.</p>
<div class="sourceCode" id="cb559"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb559-1"><a href="mixed-effects-models.html#cb559-1" aria-hidden="true" tabindex="-1"></a>complete <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb559-2"><a href="mixed-effects-models.html#cb559-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Subject =</span> <span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">21</span>),</span>
<span id="cb559-3"><a href="mixed-effects-models.html#cb559-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Intercept =</span> complete_pooling_coefs[[<span class="dv">1</span>]],</span>
<span id="cb559-4"><a href="mixed-effects-models.html#cb559-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Slope =</span> complete_pooling_coefs[[<span class="dv">2</span>]],</span>
<span id="cb559-5"><a href="mixed-effects-models.html#cb559-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model =</span> <span class="st">&quot;complete_pooling&quot;</span></span>
<span id="cb559-6"><a href="mixed-effects-models.html#cb559-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb559-7"><a href="mixed-effects-models.html#cb559-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb559-8"><a href="mixed-effects-models.html#cb559-8" aria-hidden="true" tabindex="-1"></a>model_coefs <span class="ot">&lt;-</span> <span class="fu">left_join</span>(sleep_study, complete, <span class="at">by =</span> <span class="st">&quot;Subject&quot;</span>)</span></code></pre></div>
<p>Let’s see how the data look with no pooling.</p>
<div class="sourceCode" id="cb560"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb560-1"><a href="mixed-effects-models.html#cb560-1" aria-hidden="true" tabindex="-1"></a>pooling_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(<span class="at">data =</span> model_coefs, </span>
<span id="cb560-2"><a href="mixed-effects-models.html#cb560-2" aria-hidden="true" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> Days, </span>
<span id="cb560-3"><a href="mixed-effects-models.html#cb560-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">y =</span> Reaction, </span>
<span id="cb560-4"><a href="mixed-effects-models.html#cb560-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">colour =</span> Model)</span>
<span id="cb560-5"><a href="mixed-effects-models.html#cb560-5" aria-hidden="true" tabindex="-1"></a>       ) <span class="sc">+</span></span>
<span id="cb560-6"><a href="mixed-effects-models.html#cb560-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">intercept =</span> Intercept, </span>
<span id="cb560-7"><a href="mixed-effects-models.html#cb560-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">slope =</span> Slope,</span>
<span id="cb560-8"><a href="mixed-effects-models.html#cb560-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">colour =</span> Model),</span>
<span id="cb560-9"><a href="mixed-effects-models.html#cb560-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">size =</span> <span class="fl">1.5</span></span>
<span id="cb560-10"><a href="mixed-effects-models.html#cb560-10" aria-hidden="true" tabindex="-1"></a>              ) <span class="sc">+</span></span>
<span id="cb560-11"><a href="mixed-effects-models.html#cb560-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">na.rm =</span> T) <span class="sc">+</span></span>
<span id="cb560-12"><a href="mixed-effects-models.html#cb560-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Subject)</span>
<span id="cb560-13"><a href="mixed-effects-models.html#cb560-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb560-14"><a href="mixed-effects-models.html#cb560-14" aria-hidden="true" tabindex="-1"></a><span class="co"># see the plot</span></span>
<span id="cb560-15"><a href="mixed-effects-models.html#cb560-15" aria-hidden="true" tabindex="-1"></a>pooling_plot</span></code></pre></div>
<p><img src="R-for-Psych_files/figure-html/no-pooling-1.png" width="672" /></p>
<p>Wow, so it looks like the model fits participant 18 very well. But what about participants 1, 2, and 14? Maybe a different model would fit their data better. It doesn’t do a good job of explaining their responses, that’s for sure!</p>
<p>One alternative to this complete pooling method is the opposite: no pooling. Here, we instead fit an individual intercepts and slopes to each individual in the data. We can do this by using the <code>lmer()</code> function from <strong>lme4</strong>. Here, our formula takes the form where reaction times are a function of the days (of deprived sleep) within each participant.</p>
<div class="sourceCode" id="cb561"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb561-1"><a href="mixed-effects-models.html#cb561-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit the model</span></span>
<span id="cb561-2"><a href="mixed-effects-models.html#cb561-2" aria-hidden="true" tabindex="-1"></a>no_pooling <span class="ot">&lt;-</span> <span class="fu">lmer</span>(Reaction <span class="sc">~</span> Days <span class="sc">|</span> Subject, <span class="at">data =</span> sleep_study)</span>
<span id="cb561-3"><a href="mixed-effects-models.html#cb561-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb561-4"><a href="mixed-effects-models.html#cb561-4" aria-hidden="true" tabindex="-1"></a><span class="co"># extract and view model coefficients</span></span>
<span id="cb561-5"><a href="mixed-effects-models.html#cb561-5" aria-hidden="true" tabindex="-1"></a>no_pooling_coefs <span class="ot">&lt;-</span> <span class="fu">coef</span>(no_pooling)<span class="sc">$</span>Subject <span class="sc">%&gt;%</span> </span>
<span id="cb561-6"><a href="mixed-effects-models.html#cb561-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Intercept =</span> <span class="st">`</span><span class="at">(Intercept)</span><span class="st">`</span>, <span class="at">Slope =</span> Days)</span>
<span id="cb561-7"><a href="mixed-effects-models.html#cb561-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb561-8"><a href="mixed-effects-models.html#cb561-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(no_pooling_coefs)</span></code></pre></div>
<pre><code>##         Slope Intercept
## 1 20.60380801  249.4076
## 2 -0.02559952  219.9904
## 3  3.66038038  219.0879
## 4  4.24609733  281.1159
## 5  6.27936095  278.4033
## 6  9.56692414  263.1531</code></pre>
<p>We can see for the first 6 participants their intercepts and slopes (Days) all differ from one another. How does this look in our plot? First, we’ll add the two coefficients together for easy plotting.</p>
<div class="sourceCode" id="cb563"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb563-1"><a href="mixed-effects-models.html#cb563-1" aria-hidden="true" tabindex="-1"></a>none <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb563-2"><a href="mixed-effects-models.html#cb563-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Subject =</span> <span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">21</span>),</span>
<span id="cb563-3"><a href="mixed-effects-models.html#cb563-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Intercept =</span> no_pooling_coefs<span class="sc">$</span>Intercept,</span>
<span id="cb563-4"><a href="mixed-effects-models.html#cb563-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Slope =</span> no_pooling_coefs<span class="sc">$</span>Slope,</span>
<span id="cb563-5"><a href="mixed-effects-models.html#cb563-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model =</span> <span class="st">&quot;no_pooling&quot;</span></span>
<span id="cb563-6"><a href="mixed-effects-models.html#cb563-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb563-7"><a href="mixed-effects-models.html#cb563-7" aria-hidden="true" tabindex="-1"></a>complete_none <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(complete, none)</span>
<span id="cb563-8"><a href="mixed-effects-models.html#cb563-8" aria-hidden="true" tabindex="-1"></a>model_coefs <span class="ot">&lt;-</span> <span class="fu">left_join</span>(sleep_study, complete_none, <span class="at">by =</span> <span class="st">&quot;Subject&quot;</span>)</span></code></pre></div>
<p>Now we’ve got our data in the correct format for plotting, we can have a look at how our models fit our data. Which do you think best matches the individual? Is this model any good when we have a lot of missing data?</p>
<p>Take a look at participant 20. Do you think the no pooling model is any better than the complete pooling model? What about participant 2?</p>
<div class="sourceCode" id="cb564"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb564-1"><a href="mixed-effects-models.html#cb564-1" aria-hidden="true" tabindex="-1"></a>pooling_plot <span class="sc">%+%</span> model_coefs</span></code></pre></div>
<p><img src="R-for-Psych_files/figure-html/plot-pooling-no-pooling-1.png" width="672" /></p>
<p>Finally, we get to where <strong>lme4</strong> shines; partial pooling of results. Here, we’ll fit a mixed effects model where we have fixed effects of Days, which are assumed to be</p>
<div class="sourceCode" id="cb565"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb565-1"><a href="mixed-effects-models.html#cb565-1" aria-hidden="true" tabindex="-1"></a>partial_pooling <span class="ot">&lt;-</span> <span class="fu">lmer</span>(Reaction <span class="sc">~</span> Days <span class="sc">+</span> (Days <span class="sc">|</span> Subject), <span class="at">data =</span> sleep_study)</span></code></pre></div>
<div class="sourceCode" id="cb566"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb566-1"><a href="mixed-effects-models.html#cb566-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract model coefficients</span></span>
<span id="cb566-2"><a href="mixed-effects-models.html#cb566-2" aria-hidden="true" tabindex="-1"></a>partial_pooling_coefs <span class="ot">&lt;-</span> <span class="fu">coef</span>(partial_pooling)<span class="sc">$</span>Subject</span>
<span id="cb566-3"><a href="mixed-effects-models.html#cb566-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb566-4"><a href="mixed-effects-models.html#cb566-4" aria-hidden="true" tabindex="-1"></a><span class="co"># make a tibble for partial pooling</span></span>
<span id="cb566-5"><a href="mixed-effects-models.html#cb566-5" aria-hidden="true" tabindex="-1"></a>partial <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb566-6"><a href="mixed-effects-models.html#cb566-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">Subject =</span> <span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">21</span>),</span>
<span id="cb566-7"><a href="mixed-effects-models.html#cb566-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Intercept =</span> partial_pooling_coefs<span class="sc">$</span><span class="st">`</span><span class="at">(Intercept)</span><span class="st">`</span>,</span>
<span id="cb566-8"><a href="mixed-effects-models.html#cb566-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">Slope =</span> partial_pooling_coefs<span class="sc">$</span>Days,</span>
<span id="cb566-9"><a href="mixed-effects-models.html#cb566-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">Model =</span> <span class="st">&quot;partial_pooling&quot;</span></span>
<span id="cb566-10"><a href="mixed-effects-models.html#cb566-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb566-11"><a href="mixed-effects-models.html#cb566-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb566-12"><a href="mixed-effects-models.html#cb566-12" aria-hidden="true" tabindex="-1"></a><span class="co"># clean up and combine with other models</span></span>
<span id="cb566-13"><a href="mixed-effects-models.html#cb566-13" aria-hidden="true" tabindex="-1"></a>partial <span class="ot">&lt;-</span> partial <span class="sc">%&gt;%</span></span>
<span id="cb566-14"><a href="mixed-effects-models.html#cb566-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(sleep_study, <span class="at">by =</span> <span class="st">&quot;Subject&quot;</span>)</span>
<span id="cb566-15"><a href="mixed-effects-models.html#cb566-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb566-16"><a href="mixed-effects-models.html#cb566-16" aria-hidden="true" tabindex="-1"></a>all_pools <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(model_coefs, partial)</span></code></pre></div>
<p>Next, we can plot the different models against one another to see what happens.</p>
<div class="sourceCode" id="cb567"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb567-1"><a href="mixed-effects-models.html#cb567-1" aria-hidden="true" tabindex="-1"></a>pooling_plot <span class="sc">%+%</span> all_pools</span></code></pre></div>
<p><img src="R-for-Psych_files/figure-html/plot-partial-pooling-1.png" width="672" /></p>
<p>As with TJ’s article, we’ll also zoom in to some of these participants too see what happens.</p>
<div class="sourceCode" id="cb568"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb568-1"><a href="mixed-effects-models.html#cb568-1" aria-hidden="true" tabindex="-1"></a>subset_pools <span class="ot">&lt;-</span> all_pools <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Subject <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">19</span>, <span class="dv">20</span>))</span>
<span id="cb568-2"><a href="mixed-effects-models.html#cb568-2" aria-hidden="true" tabindex="-1"></a>pooling_plot <span class="sc">%+%</span> subset_pools</span></code></pre></div>
<p><img src="R-for-Psych_files/figure-html/subset-partial-pooling-1.png" width="672" /></p>
<p>Here, you can see that in the first two cases (1 and 2), the coefficients of the partial pooling model closely matches that of the no pooling model, showing that this model closely captures the individual differences within each participant.</p>
<p>Look at participant 20. You’ll notice that the partial and complete pooling lines are more similar to one another. That’s because while the partial pooling model fits individual intercepts and slopes for each participant, it is pulled towards the mean, i.e. the overall intercept and slope across all participants. That’s called shrinkage, where extreme values are pulled towards the average. This means that in cases where we have missing data, our model takes the best bet based on the grand mean, rather than trying to guess an individual intercept and slope based on that one person’s data.</p>
<p>If you’d like to learn more about how this works, I really recommend consulting the source of this work, the article by <a href="https://tjmahr.github.io/plotting-partial-pooling-in-mixed-effects-models/">TJ Mahr on partial pooling</a>.</p>
</div>
</div>
<div id="interpreting-mixed-effects-model-output" class="section level2 hasAnchor" number="9.4">
<h2><span class="header-section-number">9.4</span> Interpreting Mixed Effects Model Output<a href="mixed-effects-models.html#interpreting-mixed-effects-model-output" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now that we’ve seen how mixed effects models work, we’ll look at how to interpret the output of a mixed effects model. For this part, we’ll use the <code>lexdec</code> dataset from the <code>languageR</code> library. Load this by loading the library and running the code below.</p>
<div class="sourceCode" id="cb569"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb569-1"><a href="mixed-effects-models.html#cb569-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(languageR)</span>
<span id="cb569-2"><a href="mixed-effects-models.html#cb569-2" aria-hidden="true" tabindex="-1"></a>lex_dec <span class="ot">&lt;-</span> <span class="fu">as.tibble</span>(lexdec) <span class="sc">%&gt;%</span> </span>
<span id="cb569-3"><a href="mixed-effects-models.html#cb569-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Subject, Trial, Word, NativeLanguage, RT)</span></code></pre></div>
<p>In this data set, we have log transformed reaction times for English words rated by native and non-native speakers of English. Let’s assume that we are interested in the influence of native language on reaction times. First, we want to set the intercept to the mean across both groups. Since the data isn’t perfectly balanced, we should avoid the base <code>contrasts()</code> method from R, and instead centre our factors, so that one level is around -.5 and the other is .5. If your values aren’t exactly -.5/.5, then your data set is unbalanced, so your should use this method.</p>
<div class="sourceCode" id="cb570"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb570-1"><a href="mixed-effects-models.html#cb570-1" aria-hidden="true" tabindex="-1"></a><span class="co"># centre the factor</span></span>
<span id="cb570-2"><a href="mixed-effects-models.html#cb570-2" aria-hidden="true" tabindex="-1"></a>lex_dec<span class="sc">$</span>lang_c <span class="ot">&lt;-</span> (lex_dec<span class="sc">$</span>NativeLanguage <span class="sc">==</span> <span class="st">&quot;English&quot;</span>) <span class="sc">-</span> <span class="fu">mean</span>(lex_dec<span class="sc">$</span>NativeLanguage <span class="sc">==</span> <span class="st">&quot;English&quot;</span>)</span>
<span id="cb570-3"><a href="mixed-effects-models.html#cb570-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb570-4"><a href="mixed-effects-models.html#cb570-4" aria-hidden="true" tabindex="-1"></a><span class="co"># see the result</span></span>
<span id="cb570-5"><a href="mixed-effects-models.html#cb570-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(lex_dec)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 6
##   Subject Trial Word       NativeLanguage    RT lang_c
##   &lt;fct&gt;   &lt;int&gt; &lt;fct&gt;      &lt;fct&gt;          &lt;dbl&gt;  &lt;dbl&gt;
## 1 A1         23 owl        English         6.34  0.429
## 2 A1         27 mole       English         6.31  0.429
## 3 A1         29 cherry     English         6.35  0.429
## 4 A1         30 pear       English         6.19  0.429
## 5 A1         32 dog        English         6.03  0.429
## 6 A1         33 blackberry English         6.18  0.429</code></pre>
<p>Then we’ll fit our model. We’ll start out with a relatively simple model where we have crossed random effects with random intercepts by subjects (Subject) and items (Word). We’ll then get a summary of our model to see what the <code>lmer</code> output looks like. We’ll fit all models with ML since we’re going to compare them to one another.</p>
<div class="sourceCode" id="cb572"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb572-1"><a href="mixed-effects-models.html#cb572-1" aria-hidden="true" tabindex="-1"></a>lexdec_mod <span class="ot">&lt;-</span> <span class="fu">lmer</span>(RT <span class="sc">~</span> lang_c <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Subject) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Word), <span class="at">data =</span> lex_dec, <span class="at">REML =</span> F)</span>
<span id="cb572-2"><a href="mixed-effects-models.html#cb572-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lexdec_mod)</span></code></pre></div>
<pre><code>## Linear mixed model fit by maximum likelihood  [&#39;lmerMod&#39;]
## Formula: RT ~ lang_c + (1 | Subject) + (1 | Word)
##    Data: lex_dec
## 
##      AIC      BIC   logLik deviance df.resid 
##   -900.1   -873.0    455.1   -910.1     1654 
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -2.3600 -0.6142 -0.1196  0.4614  5.9658 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  Word     (Intercept) 0.005896 0.07678 
##  Subject  (Intercept) 0.016741 0.12939 
##  Residual             0.029842 0.17275 
## Number of obs: 1659, groups:  Word, 79; Subject, 21
## 
## Fixed effects:
##             Estimate Std. Error t value
## (Intercept)  6.38509    0.02983 214.052
## lang_c      -0.15582    0.05769  -2.701
## 
## Correlation of Fixed Effects:
##        (Intr)
## lang_c 0.000</code></pre>
<p>There’s a few things to unpack here. First, our model was fitted with <strong>restricted maximum likelihood (REML)</strong> rather than <strong>maximum likelihood (ML)</strong>. These are just different ways to estimate the parameters of the model. Andy Field (<span class="citation">Field, Miles, and Field (<a href="#ref-field2012discovering" role="doc-biblioref">2012</a>)</span>) states that ML is typically better at estimating parameters for fixed regression parameters, and REML for random variances. The choice normally only makes a minor difference to the outcomes. However, we have to use ML if we want to compare model fits against one another.</p>
<p>Of most intereest to us are the random effects and fixed effects of the analysis. The random effects tells us how much variance in our data is captured by our random effects. Here, we can see that most of the variance is captured by the residuals (i.e. unexplained variance), but including random intercepts for subjects and items goes some way to explaining the differences in scores. Here, means are always assumed to be 0, so we only get the variance and standard deviation for these terms.</p>
<p>Next, we have the fixed effects. These roughly correspond to the parameter estimates from regular linear models that we’ve looked at. As we can see, we have a <em>t</em>-value of 2.57 for the effect of native language. The negative sign indicates that response times are slower for non-native speakers compared to the grand mean.</p>
<p>Finally, we get a correlation of our fixed effects, this is not the degree to which our fixed effects are related to one another, but is used for constructing confidence ellipses. We typically don’t use this in reporting our statistics.</p>
<div id="calculating-p-values-for-parameter-estimates" class="section level3 hasAnchor" number="9.4.1">
<h3><span class="header-section-number">9.4.1</span> Calculating p-values for Parameter Estimates<a href="mixed-effects-models.html#calculating-p-values-for-parameter-estimates" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>You may have noticed that <code>lme4</code> doesn’t provide you with <em>p</em>-values for your parameter estimates. That’s because there’s some discussion on whether or not we can accurately do so with mixed effects models, and also because the creators of lme4 would rather you use parameter estimates and their standard errors to infer the strenth of evidence for an effect.</p>
<p>We can easily calculate these using Kenward-Roger or Satterthwaite approximations, which are provided by the <strong>lmerTest</strong> and <strong>afex</strong> packages in R.</p>
<p>However, to avoid loading more packages, we can use the normal approximation to calculate <em>p</em>-values. The reasoning here is that with higher degrees of freedom, the t distribution matches the z distribution. Thus, we can treat the t-value as a z-value, essentially assuming infinite degrees of freedom.</p>
<p>Here, we look up the <em>p</em>-value that matches the absolute (non-signed) <em>t</em>-value for our parameters in the normal distribution. Then we subtract that value from 1 to get the probability of a <em>t</em>-value exceeding the one we have, and multiply that by 2 to get a two-tailed <em>p</em>-value.</p>
<p>We’ll first ensure we have the <code>broom.mixed</code> function loaded to tidy up our model results from <code>lme4</code>. This can be installed like all packages from CRAN using:</p>
<div class="sourceCode" id="cb574"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb574-1"><a href="mixed-effects-models.html#cb574-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;broom.mixed&quot;</span>) <span class="co"># install broom.mixed</span></span>
<span id="cb574-2"><a href="mixed-effects-models.html#cb574-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom.mixed) <span class="co"># load broom.mixed</span></span></code></pre></div>
<p>Then we can tidy up our <code>lme4</code> output and calculate <em>p</em>-values using the normal approximation as follows:</p>
<div class="sourceCode" id="cb575"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb575-1"><a href="mixed-effects-models.html#cb575-1" aria-hidden="true" tabindex="-1"></a>lexdec_mod <span class="sc">%&gt;%</span> </span>
<span id="cb575-2"><a href="mixed-effects-models.html#cb575-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tidy</span>(<span class="st">&quot;fixed&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb575-3"><a href="mixed-effects-models.html#cb575-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p_value =</span> <span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="fu">abs</span>(statistic))))</span></code></pre></div>
<pre><code>## # A tibble: 2 × 6
##   effect term        estimate std.error statistic p_value
##   &lt;chr&gt;  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
## 1 fixed  (Intercept)    6.39     0.0298    214.   0      
## 2 fixed  lang_c        -0.156    0.0577     -2.70 0.00692</code></pre>
<p>Just be aware that this approach somewhat inflates type-I error rates (but only slightly so with large samples).</p>
<p>Another alternative we can use to assess whether we have a main effect of a factor with multiple levels is to use a model comparisons approach, which we’ll look at next.</p>
</div>
<div id="model-selection" class="section level3 hasAnchor" number="9.4.2">
<h3><span class="header-section-number">9.4.2</span> Model Selection<a href="mixed-effects-models.html#model-selection" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>With the model comparisons approach, we simply fit our full model, and a model that is exactly the same as the full model, only without the fixed effect of interest. Here, because we want to check for a main effect of language, we simply fit a model with only an intercept term (and without an effect of language). Notice that the random effects stay the same.</p>
<div class="sourceCode" id="cb577"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb577-1"><a href="mixed-effects-models.html#cb577-1" aria-hidden="true" tabindex="-1"></a>lexdec_mod_reduced <span class="ot">&lt;-</span> <span class="fu">lmer</span>(RT <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Subject) <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Word), <span class="at">data =</span> lex_dec, <span class="at">REML =</span> F)</span></code></pre></div>
<p>Then, we use the <code>anova()</code> function to check whether inclusion of the language fixed factor significantly improves model fit. Notice also that if we originally fit our models with REML, R will refit them with ML instead.</p>
<div class="sourceCode" id="cb578"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb578-1"><a href="mixed-effects-models.html#cb578-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(lexdec_mod, lexdec_mod_reduced)</span></code></pre></div>
<pre><code>## Data: lex_dec
## Models:
## lexdec_mod_reduced: RT ~ 1 + (1 | Subject) + (1 | Word)
## lexdec_mod: RT ~ lang_c + (1 | Subject) + (1 | Word)
##                    npar     AIC     BIC logLik deviance  Chisq Df Pr(&gt;Chisq)  
## lexdec_mod_reduced    4 -895.86 -874.20 451.93  -903.86                       
## lexdec_mod            5 -900.12 -873.05 455.06  -910.12 6.2605  1    0.01235 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Here, we’re interested in the change in log-likelihood when we add terms to our model. Here, the increase in degrees of freedom should be one for each model you compare. We can see that adding the fixed effect of language significantly improved model fit, <span class="math inline">\(\chi^2(1) = 6.261, p = 0.012\)</span>. This means that we have a significant main effect of language.</p>
<p>We can similarly use this method to assess whether or not we should include random effects in our model, however whether or not you should select your random effects on the fly is again up for debate.</p>
<div class="sourceCode" id="cb580"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb580-1"><a href="mixed-effects-models.html#cb580-1" aria-hidden="true" tabindex="-1"></a>lexdec_slope <span class="ot">&lt;-</span> <span class="fu">lmer</span>(RT <span class="sc">~</span> lang_c <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Subject) <span class="sc">+</span> (lang_c <span class="sc">||</span> Word), <span class="at">data =</span> lex_dec, <span class="at">REML =</span> F)</span>
<span id="cb580-2"><a href="mixed-effects-models.html#cb580-2" aria-hidden="true" tabindex="-1"></a>lexdec_slope_cov <span class="ot">&lt;-</span> <span class="fu">lmer</span>(RT <span class="sc">~</span> lang_c <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Subject) <span class="sc">+</span> (lang_c <span class="sc">|</span> Word), <span class="at">data =</span> lex_dec, <span class="at">REML =</span> F)</span>
<span id="cb580-3"><a href="mixed-effects-models.html#cb580-3" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(lexdec_mod, lexdec_slope, lexdec_slope_cov)</span></code></pre></div>
<pre><code>## Data: lex_dec
## Models:
## lexdec_mod: RT ~ lang_c + (1 | Subject) + (1 | Word)
## lexdec_slope: RT ~ lang_c + (1 | Subject) + ((1 | Word) + (0 + lang_c | Word))
## lexdec_slope_cov: RT ~ lang_c + (1 | Subject) + (lang_c | Word)
##                  npar     AIC     BIC logLik deviance   Chisq Df Pr(&gt;Chisq)    
## lexdec_mod          5 -900.12 -873.05 455.06  -910.12                          
## lexdec_slope        6 -903.05 -870.57 457.53  -915.05  4.9348  1    0.02632 *  
## lexdec_slope_cov    7 -921.40 -883.51 467.70  -935.40 20.3514  1  6.445e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>To understand what happened here, we need to look at our random effects. Look at the summary of the model with only random intercepts by subject and item. You can see that the random effects here are calculated for the intercept terms and for the residuals.</p>
<div class="sourceCode" id="cb582"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb582-1"><a href="mixed-effects-models.html#cb582-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lexdec_mod)</span></code></pre></div>
<pre><code>## Linear mixed model fit by maximum likelihood  [&#39;lmerMod&#39;]
## Formula: RT ~ lang_c + (1 | Subject) + (1 | Word)
##    Data: lex_dec
## 
##      AIC      BIC   logLik deviance df.resid 
##   -900.1   -873.0    455.1   -910.1     1654 
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -2.3600 -0.6142 -0.1196  0.4614  5.9658 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  Word     (Intercept) 0.005896 0.07678 
##  Subject  (Intercept) 0.016741 0.12939 
##  Residual             0.029842 0.17275 
## Number of obs: 1659, groups:  Word, 79; Subject, 21
## 
## Fixed effects:
##             Estimate Std. Error t value
## (Intercept)  6.38509    0.02983 214.052
## lang_c      -0.15582    0.05769  -2.701
## 
## Correlation of Fixed Effects:
##        (Intr)
## lang_c 0.000</code></pre>
<p>Look at the next model, with random slopes added. Here, we use the double pipe (<code>||</code>) in our random effects to specify that we want random intercepts and slopes, but we don’t want to calculate the intercept-slope covariance. (But, note that this only works for numeric, continuous predictors; centering again helps here.) This can be seen in our random effects where we have <code>Word lang_c</code> which shows the slope for language by item, <code>Word.1 (Intercept)</code> which is the intercept for items, and <code>Subject (Intercept)</code> which shows the intercept for the subjects.</p>
<div class="sourceCode" id="cb584"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb584-1"><a href="mixed-effects-models.html#cb584-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lexdec_slope)</span></code></pre></div>
<pre><code>## Linear mixed model fit by maximum likelihood  [&#39;lmerMod&#39;]
## Formula: RT ~ lang_c + (1 | Subject) + ((1 | Word) + (0 + lang_c | Word))
##    Data: lex_dec
## 
##      AIC      BIC   logLik deviance df.resid 
##   -903.1   -870.6    457.5   -915.1     1653 
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -2.5314 -0.6105 -0.1222  0.4714  6.0190 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  Word     lang_c      0.002351 0.04849 
##  Word.1   (Intercept) 0.005924 0.07697 
##  Subject  (Intercept) 0.016757 0.12945 
##  Residual             0.029237 0.17099 
## Number of obs: 1659, groups:  Word, 79; Subject, 21
## 
## Fixed effects:
##             Estimate Std. Error t value
## (Intercept)  6.38509    0.02984 213.959
## lang_c      -0.15582    0.05797  -2.688
## 
## Correlation of Fixed Effects:
##        (Intr)
## lang_c 0.000</code></pre>
<p>Finally, if we look at the more complex model, we can see that we have intercepts and slopes for the items, and we’ve calculated the covariance between these terms (in the <code>Corr</code> column.</p>
<div class="sourceCode" id="cb586"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb586-1"><a href="mixed-effects-models.html#cb586-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lexdec_slope_cov)</span></code></pre></div>
<pre><code>## Linear mixed model fit by maximum likelihood  [&#39;lmerMod&#39;]
## Formula: RT ~ lang_c + (1 | Subject) + (lang_c | Word)
##    Data: lex_dec
## 
##      AIC      BIC   logLik deviance df.resid 
##   -921.4   -883.5    467.7   -935.4     1652 
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -2.6132 -0.6175 -0.1112  0.4677  6.1894 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev. Corr 
##  Word     (Intercept) 0.005924 0.07697       
##           lang_c      0.002349 0.04846  -0.98
##  Subject  (Intercept) 0.016757 0.12945       
##  Residual             0.029237 0.17099       
## Number of obs: 1659, groups:  Word, 79; Subject, 21
## 
## Fixed effects:
##             Estimate Std. Error t value
## (Intercept)  6.38509    0.02984 213.961
## lang_c      -0.15582    0.05797  -2.688
## 
## Correlation of Fixed Effects:
##        (Intr)
## lang_c -0.027</code></pre>
<p>It seems that this model better explains our data than the other models, so we should probably use this one. Still, the choice of random effects structure can be as much driven by your assumptions and knowledge of the source of the data as from these data driven techniques.</p>
</div>
<div id="failure-to-converge-what-should-i-do" class="section level3 hasAnchor" number="9.4.3">
<h3><span class="header-section-number">9.4.3</span> Failure to Converge: What Should I Do?<a href="mixed-effects-models.html#failure-to-converge-what-should-i-do" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Often, when you attempt to fit the maximal random effects structure you will get an error saying that your model failed to converge. This means that you don’t have enough information in your data (or your data is so noisy) that you cannot properly identify the full variance covariance matrix for the model. This happens a lot if you have variances that are equal or nearly equal to 0, or correlations in terms that are equal to -1 or 1.</p>
<p>One way to avoid problems with converging is to centre your factors (as we have done above) and use numeric predictors in your model. You can also try to use a different optimiser by specifying the options in <code>lme4</code>. You can specify your optimiser like so. Check out the summaries of these models to see how they differ. Basically, these optimisers are just different methods for attempting to find the best fitting model for your data.</p>
<div class="sourceCode" id="cb588"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb588-1"><a href="mixed-effects-models.html#cb588-1" aria-hidden="true" tabindex="-1"></a>nelder_mod <span class="ot">&lt;-</span> <span class="fu">lmer</span>(</span>
<span id="cb588-2"><a href="mixed-effects-models.html#cb588-2" aria-hidden="true" tabindex="-1"></a>  RT <span class="sc">~</span> lang_c <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Subject) <span class="sc">+</span> (lang_c <span class="sc">|</span> Word), </span>
<span id="cb588-3"><a href="mixed-effects-models.html#cb588-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> lex_dec, <span class="at">REML =</span> F, </span>
<span id="cb588-4"><a href="mixed-effects-models.html#cb588-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> <span class="fu">lmerControl</span>(<span class="at">optimizer =</span> <span class="st">&quot;Nelder_Mead&quot;</span>)</span>
<span id="cb588-5"><a href="mixed-effects-models.html#cb588-5" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb588-6"><a href="mixed-effects-models.html#cb588-6" aria-hidden="true" tabindex="-1"></a>boby_mod <span class="ot">&lt;-</span> <span class="fu">lmer</span>(</span>
<span id="cb588-7"><a href="mixed-effects-models.html#cb588-7" aria-hidden="true" tabindex="-1"></a>  RT <span class="sc">~</span> lang_c <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> Subject) <span class="sc">+</span> (lang_c <span class="sc">|</span> Word), </span>
<span id="cb588-8"><a href="mixed-effects-models.html#cb588-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> lex_dec, <span class="at">REML =</span> F, </span>
<span id="cb588-9"><a href="mixed-effects-models.html#cb588-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> <span class="fu">lmerControl</span>(<span class="at">optimizer =</span> <span class="st">&quot;bobyqa&quot;</span>)</span>
<span id="cb588-10"><a href="mixed-effects-models.html#cb588-10" aria-hidden="true" tabindex="-1"></a>     )</span></code></pre></div>
<p>Also, if you have complex models, with intercepts and slopes calculated for subjects and items for something that is also a fixed effect, your model can effectively run out of the degrees of freedom to estimate the correlations between your intercepts and slopes. One work around here is to just simplify your model. There are a number of suggestions for how you should do this.</p>
<p>In psychological research, <a href="https://hlplab.wordpress.com/2009/05/14/random-effect-structure/">one suggested procedure</a> is as follows:</p>
<p>For a model specified as <code>lmer(outcome ~ A * B + (1 + A * B | subjects) + (1 + A * B | items), data)</code>:</p>
<ul>
<li>First remove the correlations between random effects, i.e. <code>(1 + A + B | subjects) + (1 + A + B | items)</code></li>
<li>If that doesn’t converge, remove the by-items slopes for one factor (which explains the least variance) first. <code>(1 + A + B | subjects) + (1 + A | items)</code></li>
<li>If that doesn’t converge, remove the reamining by-items slopes <code>(1 + A + B | subjects) + (1 | items)</code></li>
<li>Remove slopes on subjects until it eventually converges</li>
</ul>
<p>The reasoning here is that in our experiments we attempt to control as many confounds in our items as possible, such that variance within items should be smaller than variance within subjects.</p>
<p>If your model doesn’t converge with random intercepts by both terms, you should probably explore your data for potential problems.</p>
</div>
</div>
<div id="test-assumptions" class="section level2 hasAnchor" number="9.5">
<h2><span class="header-section-number">9.5</span> Test Assumptions<a href="mixed-effects-models.html#test-assumptions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>While mixed effects models get around many of the stricter assumptions from linear models, these models still make some assumptions. Some assumptions you need to worry about include:</p>
<ul>
<li><p>Linearity: Unsurprisingly, linear models require linearly related data. You can check for this with a graph as in previous sections. Alternatively, you can fit a non-linear function to your model.</p></li>
<li><p>Independence: If your data are not independent (e.g. with multiple responses per participant) then your model must specify this is the case through your random effects. Failing to do so will lead to violations of this assumption, and incorrectly fitted models.</p></li>
<li><p>Normal Distribution of Random Coefficients: random coefficients are assumed to be normally distributed around the model. For random intercepts models this means that your intercepts are supposed to be normally distributed around the overall model (<span class="citation">Field, Miles, and Field (<a href="#ref-field2012discovering" role="doc-biblioref">2012</a>)</span>).</p></li>
<li><p>Multicollinearity: This is where one predictor in your model can be can be reasonably accurately linearly predicted from the other predictors in your model. You can check for this by using the <code>vif()</code> function from the <code>usdm</code> library. Centering your predictors can help with problems of multicollinearity.</p></li>
<li><p>Homoscedasticity: The error term in your model should be the same across all of your variables. You could use a Levene’s test or a plot of residuals vs. fitted values, as with regular linear models.</p></li>
<li><p>Outliers: Large outliers will skew your data. You can check for these using any traditional means, e.g. eye-balling your data via graphs or excluding based on some reasonable criteria (e.g. + 3SD above the mean). Just make sure you have a principled decision for excluding data.</p></li>
</ul>
</div>
<div id="generalised-mixed-effects-models" class="section level2 hasAnchor" number="9.6">
<h2><span class="header-section-number">9.6</span> Generalised Mixed Effects Models<a href="mixed-effects-models.html#generalised-mixed-effects-models" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Generalised mixed effects models are performed in a similar way to mixed effects models, but are applied to cases when your outcome or dependent variable is not normally distributed, e.g. logistic regression for binary response data. These models use the same logic as generalised linear models, and the interpretation is very similar to mixed effects models. However here the <em>p</em>-values are calculated for the fixed effects coefficients straight out of the model!</p>
<p>We implement these models for binary response data like so:</p>
<div class="sourceCode" id="cb589"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb589-1"><a href="mixed-effects-models.html#cb589-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glmer</span>(</span>
<span id="cb589-2"><a href="mixed-effects-models.html#cb589-2" aria-hidden="true" tabindex="-1"></a>  DV_binom <span class="sc">~</span> <span class="co"># binomial dependent variable</span></span>
<span id="cb589-3"><a href="mixed-effects-models.html#cb589-3" aria-hidden="true" tabindex="-1"></a>    A <span class="sc">*</span> B <span class="sc">+</span> <span class="co"># fixed effects</span></span>
<span id="cb589-4"><a href="mixed-effects-models.html#cb589-4" aria-hidden="true" tabindex="-1"></a>    (A <span class="sc">*</span> B <span class="sc">|</span> subject) <span class="sc">+</span> (A <span class="sc">*</span> B <span class="sc">|</span> item), <span class="co"># random effects </span></span>
<span id="cb589-5"><a href="mixed-effects-models.html#cb589-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> binomial, <span class="co"># family: type of distribution</span></span>
<span id="cb589-6"><a href="mixed-effects-models.html#cb589-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data, </span>
<span id="cb589-7"><a href="mixed-effects-models.html#cb589-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glmerControl</span>(<span class="at">optimizer =</span> <span class="st">&quot;bobyqa&quot;</span>) <span class="co"># options; notice glmerControl (not lmer)</span></span>
<span id="cb589-8"><a href="mixed-effects-models.html#cb589-8" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p>For proportions, we simply set the weights of the model to the number of success and provide the proportions as our dependent variable.</p>
<div class="sourceCode" id="cb590"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb590-1"><a href="mixed-effects-models.html#cb590-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glmer</span>(</span>
<span id="cb590-2"><a href="mixed-effects-models.html#cb590-2" aria-hidden="true" tabindex="-1"></a>  DV_prop <span class="sc">~</span> <span class="co"># dependent variable as a proportion</span></span>
<span id="cb590-3"><a href="mixed-effects-models.html#cb590-3" aria-hidden="true" tabindex="-1"></a>    A <span class="sc">*</span> B <span class="sc">+</span> <span class="co"># fixed effects</span></span>
<span id="cb590-4"><a href="mixed-effects-models.html#cb590-4" aria-hidden="true" tabindex="-1"></a>    (A <span class="sc">*</span> B <span class="sc">|</span> subject) <span class="sc">+</span> (A <span class="sc">*</span> B <span class="sc">|</span> item), <span class="co"># random effects </span></span>
<span id="cb590-5"><a href="mixed-effects-models.html#cb590-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> binomial, <span class="co"># family: type of distribution</span></span>
<span id="cb590-6"><a href="mixed-effects-models.html#cb590-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">weights =</span> N_observations, <span class="co"># number of observations making up the proportion</span></span>
<span id="cb590-7"><a href="mixed-effects-models.html#cb590-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data,</span>
<span id="cb590-8"><a href="mixed-effects-models.html#cb590-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glmerControl</span>(<span class="at">optimizer =</span> <span class="st">&quot;bobyqa&quot;</span>)<span class="co"># options; notice glmerControl (not lmer)</span></span>
<span id="cb590-9"><a href="mixed-effects-models.html#cb590-9" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p>Alternatively, we can calculate these within the model if we have the number of successes and the number of observations as columns in our model.</p>
<div class="sourceCode" id="cb591"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb591-1"><a href="mixed-effects-models.html#cb591-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glmer</span>(</span>
<span id="cb591-2"><a href="mixed-effects-models.html#cb591-2" aria-hidden="true" tabindex="-1"></a>  DV_successes<span class="sc">/</span>N_observations <span class="sc">~</span> <span class="co"># calculate proportion</span></span>
<span id="cb591-3"><a href="mixed-effects-models.html#cb591-3" aria-hidden="true" tabindex="-1"></a>    A <span class="sc">*</span> B <span class="sc">+</span> <span class="co"># fixed effects</span></span>
<span id="cb591-4"><a href="mixed-effects-models.html#cb591-4" aria-hidden="true" tabindex="-1"></a>    (A <span class="sc">*</span> B <span class="sc">|</span> subject) <span class="sc">+</span> (A <span class="sc">*</span> B <span class="sc">|</span> item), <span class="co"># random effects </span></span>
<span id="cb591-5"><a href="mixed-effects-models.html#cb591-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">family =</span> binomial, <span class="co"># family: type of distribution</span></span>
<span id="cb591-6"><a href="mixed-effects-models.html#cb591-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">weights =</span> N_observations, <span class="co"># number of observations making up the proportion</span></span>
<span id="cb591-7"><a href="mixed-effects-models.html#cb591-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data,</span>
<span id="cb591-8"><a href="mixed-effects-models.html#cb591-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glmerControl</span>(<span class="at">optimizer =</span> <span class="st">&quot;bobyqa&quot;</span>) <span class="co"># options; notice glmerControl (not lmer)</span></span>
<span id="cb591-9"><a href="mixed-effects-models.html#cb591-9" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<p>Here, our parameter estimates are interpreted as log likelihoods.</p>
</div>
<div id="a-note-on-power-effect-sizes-and-pairwise-comparisons" class="section level2 hasAnchor" number="9.7">
<h2><span class="header-section-number">9.7</span> A Note on Power, Effect Sizes, and Pairwise Comparisons<a href="mixed-effects-models.html#a-note-on-power-effect-sizes-and-pairwise-comparisons" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="power" class="section level3 hasAnchor" number="9.7.1">
<h3><span class="header-section-number">9.7.1</span> Power<a href="mixed-effects-models.html#power" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Power analysis is rather complex for mixed effects models. Here, simulation is key, and there are some packages out there to help you perform your own power analyses with little coding, such as SIMR (<code>install.packages("simr")</code>). You can find a paper on <a href="https://besjournals.onlinelibrary.wiley.com/doi/abs/10.1111/2041-210X.12504">how to use SIMR here</a>.</p>
</div>
<div id="effect-sizes" class="section level3 hasAnchor" number="9.7.2">
<h3><span class="header-section-number">9.7.2</span> Effect Sizes<a href="mixed-effects-models.html#effect-sizes" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Effect sizes for individual parameter estimates and/or the entire model fit are often not reported with mixed effects models due to the practical and/or technical difficulties posed by calculating effect sizes. However, there are some options out there, such as that offered by the <code>r2beta()</code> function from the <strong>r2glmm package</strong>, or the <code>r.squaredGLMM()</code> function from the <strong>MuMIn package</strong>. I’ll leave it up to you to explore these options, but we might return to this in the final lesson.</p>
</div>
<div id="pairwise-comparisons" class="section level3 hasAnchor" number="9.7.3">
<h3><span class="header-section-number">9.7.3</span> Pairwise Comparisons<a href="mixed-effects-models.html#pairwise-comparisons" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Pairwise comparisons can be conducted in the same way as for linear models. You can either subset your data to the a single level of one factor to explore the simple effects for another factor, adjusting your <em>p</em>-values manually in the process, or you can use the <code>glht()</code> function from the <strong>multcomp</strong> package.</p>
</div>
</div>
<div id="exercises-8" class="section level2 hasAnchor" number="9.8">
<h2><span class="header-section-number">9.8</span> Exercises<a href="mixed-effects-models.html#exercises-8" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>For these exercises, we will look at the core concepts from this lesson. Here, we’ll use a simulated data set that’s saved as a .csv in the inputs folder.</p>
<p>If you don’t have access to these, please <a href="https://github.com/gpwilliams/r4psych">download the repository from GitHub</a> and open the <strong>lesson_materials</strong> folder. Open the relevant folder for this lesson. If you work out of the file <strong>09_mixed_effects_models.Rmd</strong> the code below will work to load the data set. If this fails then quit R and open it up from the .Rmd file above so your working directory is in the correct folder.</p>
<div class="sourceCode" id="cb592"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb592-1"><a href="mixed-effects-models.html#cb592-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb592-2"><a href="mixed-effects-models.html#cb592-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span></code></pre></div>
<div class="sourceCode" id="cb593"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb593-1"><a href="mixed-effects-models.html#cb593-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;inputs/factorial_data.csv&quot;</span>)</span></code></pre></div>
<div id="question-1-8" class="section level3 hasAnchor" number="9.8.1">
<h3><span class="header-section-number">9.8.1</span> Question 1<a href="mixed-effects-models.html#question-1-8" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Summarise the data, creating means, standard deviations, and ns for each group in the data set.</p>
</div>
<div id="question-2-8" class="section level3 hasAnchor" number="9.8.2">
<h3><span class="header-section-number">9.8.2</span> Question 2<a href="mixed-effects-models.html#question-2-8" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Centre the factors A and B in preparation for fitting the model. Define the centred variables for A and B as <strong>A_c</strong> and <strong>B_c</strong> respectively. Return the data set to see what you did to the data frame.</p>
</div>
<div id="question-3-8" class="section level3 hasAnchor" number="9.8.3">
<h3><span class="header-section-number">9.8.3</span> Question 3<a href="mixed-effects-models.html#question-3-8" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: lower-alpha">
<li>Find maximal random effects structure for the model and call this <strong>maximal_model</strong>. Return the a summary of the model output when you’re done. Assume that the data from which this is taken is not nested. This model may take a while to fit, so be patient!</li>
<li>Where is most of the variance explained? What does this tell us about the model (i.e. is it overfitting the data)?</li>
<li>Are there any perfect correlations between the random effects? What does this tell us about our random effects structure?</li>
</ol>
</div>
<div id="question-4-8" class="section level3 hasAnchor" number="9.8.4">
<h3><span class="header-section-number">9.8.4</span> Question 4<a href="mixed-effects-models.html#question-4-8" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Explore the whether inclusion of the interaction significantly improves model fit over a model with just main effects. Be sure to include all random effects in all models.</p>
</div>
<div id="question-5-8" class="section level3 hasAnchor" number="9.8.5">
<h3><span class="header-section-number">9.8.5</span> Question 5<a href="mixed-effects-models.html#question-5-8" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Calculate <em>p</em>-values for the parameters in your maximal model (including interactions) using the normal approximation. Round each number to 2 decimal places.</p>
</div>
<div id="question-6-8" class="section level3 hasAnchor" number="9.8.6">
<h3><span class="header-section-number">9.8.6</span> Question 6<a href="mixed-effects-models.html#question-6-8" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Explore the interaction by subsetting the data to each level of factor A and fitting a model containing factor B. Then do the same for the remaining factor. Where does the interaction lie?</p>
<p>First, subset the data as described above, and assign this to four objects called A1_dat, A2_dat, B1_dat, and B2_dat respectively.</p>
<p>Then, fit four models looking at the main effect of one factor within each subset of data.</p>
<p>Next, extract a tidied version of the coefficients from each model and add a column identifying which comparison these models are from. Assign these to A1_comp, A2_comp, B1_comp and B2_comp respectively, showing that these objects contain the comparisons for each level.</p>
<p>Finally, bind the rows together from your comparisons, and create a <em>p</em>-value for your data using the normal approximation. Be sure to bonferroni correct your data. After the correction, make sure that you reset any <em>p</em>-values above 1 to 1 (as <em>p</em>-values above 1 don’t make any sense).</p>
</div>
<div id="question-7-7" class="section level3 hasAnchor" number="9.8.7">
<h3><span class="header-section-number">9.8.7</span> Question 7<a href="mixed-effects-models.html#question-7-7" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Make a plot showing the interaction between A and B.</p>

</div>
</div>
</div>
<h3>References<a href="references.html#references" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-field2012discovering" class="csl-entry">
Field, Andy, Jeremy Miles, and Zoë Field. 2012. <em>Discovering Statistics Using r</em>. Sage publications.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="simulation-and-calculating-power.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="reporting-reproducible-research.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="assets/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
},
"toolbar": {
"position": "static"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
